import{a as t,j as m,F as ht}from"./jsx-runtime-Cxo6Vr6b.js";import{r as d,R as _}from"./index-BBkUAzwr.js";import{i as se,t as qt,w as Pt,u as F,q as xt,F as S,c as f,a as X,b as W,d as G,S as x,r as A,v as fe,h as He,j as Ue,x as V,T as ze,k as Xe,l as We,y as Ge,z as Je,A as Ye,B as Qe,D as re,m as Ze,n as et,o as q,N as It,p as kt,E as ft,G as gt,H as $t,J as Ht}from"./StatusFilter-B_IYX4Do.js";import{_ as J,p as ve,n as O,B as ne,r as Ut,v as zt,w as Xt,A as Te,M as Wt,x as Gt,y as Jt,z as Yt,P as Qt,D as oe,o as Zt,F as bt,G as en,q as yt,H as tn,I as nn,J as vt,K as U,L as I,N as z,g as ie,e as P,h as k,T as tt,d as nt,f as N,O as lt,Q as ge,R as L,S as Ct,i as we}from"./data-D4XSKuO1.js";const h={button:"pf-v5-c-button",dirRtl:"pf-v5-m-dir-rtl",modifiers:{fill:"pf-m-fill",scrollable:"pf-m-scrollable",noBorderBottom:"pf-m-no-border-bottom",box:"pf-m-box",vertical:"pf-m-vertical",current:"pf-m-current",colorSchemeLight_300:"pf-m-color-scheme--light-300",expandable:"pf-m-expandable",nonExpandable:"pf-m-non-expandable",expandableOnSm:"pf-m-expandable-on-sm",nonExpandableOnSm:"pf-m-non-expandable-on-sm",expandableOnMd:"pf-m-expandable-on-md",nonExpandableOnMd:"pf-m-non-expandable-on-md",expandableOnLg:"pf-m-expandable-on-lg",nonExpandableOnLg:"pf-m-non-expandable-on-lg",expandableOnXl:"pf-m-expandable-on-xl",nonExpandableOnXl:"pf-m-non-expandable-on-xl",expandableOn_2xl:"pf-m-expandable-on-2xl",nonExpandableOn_2xl:"pf-m-non-expandable-on-2xl",expanded:"pf-m-expanded",secondary:"pf-m-secondary",pageInsets:"pf-m-page-insets",overflow:"pf-m-overflow",action:"pf-m-action",active:"pf-m-active",disabled:"pf-m-disabled",ariaDisabled:"pf-m-aria-disabled",insetNone:"pf-m-inset-none",insetSm:"pf-m-inset-sm",insetMd:"pf-m-inset-md",insetLg:"pf-m-inset-lg",insetXl:"pf-m-inset-xl",inset_2xl:"pf-m-inset-2xl",insetNoneOnSm:"pf-m-inset-none-on-sm",insetSmOnSm:"pf-m-inset-sm-on-sm",insetMdOnSm:"pf-m-inset-md-on-sm",insetLgOnSm:"pf-m-inset-lg-on-sm",insetXlOnSm:"pf-m-inset-xl-on-sm",inset_2xlOnSm:"pf-m-inset-2xl-on-sm",insetNoneOnMd:"pf-m-inset-none-on-md",insetSmOnMd:"pf-m-inset-sm-on-md",insetMdOnMd:"pf-m-inset-md-on-md",insetLgOnMd:"pf-m-inset-lg-on-md",insetXlOnMd:"pf-m-inset-xl-on-md",inset_2xlOnMd:"pf-m-inset-2xl-on-md",insetNoneOnLg:"pf-m-inset-none-on-lg",insetSmOnLg:"pf-m-inset-sm-on-lg",insetMdOnLg:"pf-m-inset-md-on-lg",insetLgOnLg:"pf-m-inset-lg-on-lg",insetXlOnLg:"pf-m-inset-xl-on-lg",inset_2xlOnLg:"pf-m-inset-2xl-on-lg",insetNoneOnXl:"pf-m-inset-none-on-xl",insetSmOnXl:"pf-m-inset-sm-on-xl",insetMdOnXl:"pf-m-inset-md-on-xl",insetLgOnXl:"pf-m-inset-lg-on-xl",insetXlOnXl:"pf-m-inset-xl-on-xl",inset_2xlOnXl:"pf-m-inset-2xl-on-xl",insetNoneOn_2xl:"pf-m-inset-none-on-2xl",insetSmOn_2xl:"pf-m-inset-sm-on-2xl",insetMdOn_2xl:"pf-m-inset-md-on-2xl",insetLgOn_2xl:"pf-m-inset-lg-on-2xl",insetXlOn_2xl:"pf-m-inset-xl-on-2xl",inset_2xlOn_2xl:"pf-m-inset-2xl-on-2xl"},tabs:"pf-v5-c-tabs",tabsAdd:"pf-v5-c-tabs__add",tabsItem:"pf-v5-c-tabs__item",tabsItemAction:"pf-v5-c-tabs__item-action",tabsItemActionIcon:"pf-v5-c-tabs__item-action-icon",tabsItemIcon:"pf-v5-c-tabs__item-icon",tabsItemText:"pf-v5-c-tabs__item-text",tabsLink:"pf-v5-c-tabs__link",tabsLinkToggleIcon:"pf-v5-c-tabs__link-toggle-icon",tabsList:"pf-v5-c-tabs__list",tabsScrollButton:"pf-v5-c-tabs__scroll-button",tabsToggle:"pf-v5-c-tabs__toggle",tabsToggleButton:"pf-v5-c-tabs__toggle-button",tabsToggleIcon:"pf-v5-c-tabs__toggle-icon",tabsToggleText:"pf-v5-c-tabs__toggle-text",themeDark:"pf-v5-theme-dark"},rt=e=>{var{children:n,tabContentRef:l,ouiaId:r,parentInnerRef:i,ouiaSafe:a}=e,o=J(e,["children","tabContentRef","ouiaId","parentInnerRef","ouiaSafe"]);const u=o.href?"a":"button";return d.createElement(u,Object.assign({},!o.href&&{type:"button"},{ref:i},ve(rt.displayName,r,a),o),n)};rt.displayName="TabButton";const Ce=d.createContext({variant:"default",mountOnEnter:!1,unmountOnExit:!1,localActiveKey:"",uniqueId:"",handleTabClick:()=>null,handleTabClose:void 0}),ln=Ce.Provider,rn=Ce.Consumer,an=e=>{var{children:n,className:l,onClick:r,isDisabled:i,"aria-label":a="Tab action",innerRef:o,ouiaId:u,ouiaSafe:c}=e,s=J(e,["children","className","onClick","isDisabled","aria-label","innerRef","ouiaId","ouiaSafe"]);return d.createElement("span",{className:O(h.tabsItemAction,l)},d.createElement(ne,Object.assign({ref:o,type:"button",variant:"plain","aria-label":a,onClick:r,isDisabled:i},ve(it.displayName,u,c),s),d.createElement("span",{className:O(h.tabsItemActionIcon)},n)))},it=d.forwardRef((e,n)=>d.createElement(an,Object.assign({},e,{innerRef:n})));it.displayName="TabAction";const on=e=>{var{title:n,eventKey:l,tabContentRef:r,id:i,tabContentId:a,className:o="",ouiaId:u,isDisabled:c,isAriaDisabled:s,inoperableEvents:g=["onClick","onKeyPress"],href:p,innerRef:v,tooltip:w,closeButtonAriaLabel:y,isCloseDisabled:E=!1,actions:B}=e,Y=J(e,["title","eventKey","tabContentRef","id","tabContentId","className","ouiaId","isDisabled","isAriaDisabled","inoperableEvents","href","innerRef","tooltip","closeButtonAriaLabel","isCloseDisabled","actions"]);const D=g.reduce((K,Se)=>Object.assign(Object.assign({},K),{[Se]:_e=>{_e.preventDefault()}}),{}),{mountOnEnter:Q,localActiveKey:$,unmountOnExit:Z,uniqueId:ee,handleTabClick:ae,handleTabClose:H}=d.useContext(Ce);let b=a?`${a}`:`pf-tab-section-${l}-${i||ee}`;(Q||Z)&&l!==$&&(b=void 0);const T=!p,j=()=>{if(c)return T?null:-1;if(s)return null},M=d.createElement(rt,Object.assign({parentInnerRef:v,className:O(h.tabsLink,c&&p&&h.modifiers.disabled,s&&h.modifiers.ariaDisabled),disabled:T?c:null,"aria-disabled":c||s,tabIndex:j(),onClick:K=>ae(K,l,r)},s?D:null,{id:`pf-tab-${l}-${i||ee}`,"aria-controls":b,tabContentRef:r,ouiaId:u,href:p,role:"tab","aria-selected":l===$},Y),n);return d.createElement("li",{className:O(h.tabsItem,l===$&&h.modifiers.current,(H||B)&&h.modifiers.action,(c||s)&&h.modifiers.disabled,o),role:"presentation"},w?d.createElement(Ut,Object.assign({},w.props),M):M,B&&B,H!==void 0&&d.createElement(it,{"aria-label":y||"Close tab",onClick:K=>H(K,l,r),isDisabled:E},d.createElement(zt,null)))},he=d.forwardRef((e,n)=>d.createElement(on,Object.assign({innerRef:n},e)));he.displayName="Tab";const sn={name:"PlusIcon",height:512,width:448,svgPath:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",yOffset:0,xOffset:0},cn=Xt(sn),Oe={modifiers:{light_300:"pf-m-light-300",padding:"pf-m-padding"},tabContent:"pf-v5-c-tab-content",tabContentBody:"pf-v5-c-tab-content__body"},St={default:"",light300:Oe.modifiers.light_300},dn=e=>{var{id:n,activeKey:l,"aria-label":r,child:i,children:a,className:o,eventKey:u,innerRef:c,ouiaId:s,ouiaSafe:g}=e,p=J(e,["id","activeKey","aria-label","child","children","className","eventKey","innerRef","ouiaId","ouiaSafe"]);if(a||i){let v;return r?v=null:v=a?`${n}`:`pf-tab-${i.props.eventKey}-${n}`,d.createElement(rn,null,({variant:w})=>d.createElement("section",Object.assign({ref:c,hidden:a?null:i.props.eventKey!==l,className:a?O(Oe.tabContent,o,St[w]):O(Oe.tabContent,i.props.className,St[w]),id:a?n:`pf-tab-section-${i.props.eventKey}-${n}`,"aria-label":r,"aria-labelledby":v,role:"tabpanel",tabIndex:0},ve("TabContent",s,g),p),a||i.props.children))}return null},un=d.forwardRef((e,n)=>d.createElement(dn,Object.assign({},e,{innerRef:n}))),ce=e=>{var{children:n,className:l=""}=e,r=J(e,["children","className"]);return d.createElement("span",Object.assign({className:O(h.tabsItemText,l)},r),n)};ce.displayName="TabTitleText";const wt=e=>{var{className:n,overflowingTabs:l=[],showTabCount:r,defaultTitleText:i="More",toggleAriaLabel:a,zIndex:o=9999}=e,u=J(e,["className","overflowingTabs","showTabCount","defaultTitleText","toggleAriaLabel","zIndex"]);const c=_.useRef(),s=_.useRef(),g=_.useRef(),[p,v]=_.useState(!1),{localActiveKey:w,handleTabClick:y}=_.useContext(Ce),E=()=>{v(!1),s.current.focus()},B=b=>{var T;const j=(T=c==null?void 0:c.current)===null||T===void 0?void 0:T.contains(b.target);p&&j&&b.key==="Escape"&&E()},Y=b=>{var T,j;const M=!(!((T=c==null?void 0:c.current)===null||T===void 0)&&T.contains(b.target)),K=!(!((j=s==null?void 0:s.current)===null||j===void 0)&&j.contains(b.target));p&&M&&K&&E()};_.useEffect(()=>(window.addEventListener("click",Y),window.addEventListener("keydown",B),()=>{window.removeEventListener("click",Y),window.removeEventListener("keydown",B)}),[p,c,s]);const D=l.find(b=>b.eventKey===w),Q=D!=null&&D.title?D.title:i,$=()=>{v(b=>!b),setTimeout(()=>{if(c!=null&&c.current){const b=c.current.querySelector("li > button,input:not(:disabled)");b&&b.focus()}},0)},Z=_.createElement("li",Object.assign({className:O(h.tabsItem,"pf-m-overflow",D&&h.modifiers.current,n),role:"presentation",ref:g},u),_.createElement("button",{type:"button",className:O(h.tabsLink,p&&h.modifiers.expanded),onClick:()=>$(),"aria-label":a,"aria-haspopup":"menu","aria-expanded":p,role:"tab",ref:s},_.createElement(ce,null,Q,r&&Q===i&&` (${l.length})`),_.createElement("span",{className:h.tabsLinkToggleIcon},_.createElement(Te,null)))),ee=l.map(b=>_.createElement(Wt,{key:b.eventKey,itemId:b.eventKey,isSelected:w===b.eventKey},b.title)),ae=(b,T)=>{E();const j=l.find(M=>M.eventKey===T).tabContentRef;y(b,T,j)},H=_.createElement(Gt,{ref:c,onSelect:(b,T)=>ae(b,T)},_.createElement(Jt,null,_.createElement(Yt,null,ee)));return _.createElement(_.Fragment,null,Z,_.createElement(Qt,{triggerRef:s,popper:H,popperRef:c,isVisible:p,minWidth:"revert",appendTo:g.current,zIndex:o}))};wt.displayName="OverflowTab";var be;(function(e){e.div="div",e.nav="nav"})(be||(be={}));const mn={default:"",light300:h.modifiers.colorSchemeLight_300};class le extends d.Component{constructor(n){super(n),this.tabList=d.createRef(),this.leftScrollButtonRef=d.createRef(),this.direction="ltr",this.scrollTimeout=null,this.countOverflowingElements=l=>Array.from(l.children).filter(i=>!oe(l,i)).length,this.handleScrollButtons=()=>{const{isOverflowHorizontal:l}=this.props;clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{const r=this.tabList.current;let i=!0,a=!0,o=!1,u=0;if(r&&!this.props.isVertical&&!l){const c=!oe(r,r.firstChild),s=!oe(r,r.lastChild);o=c||s,i=!c,a=!s}l&&(u=this.countOverflowingElements(r)),this.setState({enableScrollButtons:o,disableBackScrollButton:i,disableForwardScrollButton:a,overflowingTabCount:u})},100)},this.scrollBack=()=>{if(this.tabList.current){const l=this.tabList.current,r=Array.from(l.children);let i,a,o;for(o=0;o<r.length&&!i;o++)oe(l,r[o])&&(i=r[o],a=r[o-1]);a&&(this.direction==="ltr"?l.scrollLeft-=a.scrollWidth:l.scrollLeft+=a.scrollWidth)}},this.scrollForward=()=>{if(this.tabList.current){const l=this.tabList.current,r=Array.from(l.children);let i,a;for(let o=r.length-1;o>=0&&!i;o--)oe(l,r[o])&&(i=r[o],a=r[o+1]);a&&(this.direction==="ltr"?l.scrollLeft+=a.scrollWidth:l.scrollLeft-=a.scrollWidth)}},this.hideScrollButtons=()=>{const{enableScrollButtons:l,renderScrollButtons:r,showScrollButtons:i}=this.state;!l&&!i&&r&&this.setState({renderScrollButtons:!1})},this.state={enableScrollButtons:!1,showScrollButtons:!1,renderScrollButtons:!1,disableBackScrollButton:!0,disableForwardScrollButton:!0,shownKeys:this.props.defaultActiveKey!==void 0?[this.props.defaultActiveKey]:[this.props.activeKey],uncontrolledActiveKey:this.props.defaultActiveKey,uncontrolledIsExpandedLocal:this.props.defaultIsExpanded,ouiaStateId:Zt(le.displayName),overflowingTabCount:0},this.props.isVertical&&this.props.expandable!==void 0&&!this.props.toggleAriaLabel&&!this.props.toggleText&&console.error("Tabs:","toggleAriaLabel or the toggleText prop is required to make the toggle button accessible")}handleTabClick(n,l,r){const{shownKeys:i}=this.state,{onSelect:a,defaultActiveKey:o}=this.props;o!==void 0?this.setState({uncontrolledActiveKey:l}):a(n,l),r&&(d.Children.toArray(this.props.children).filter(u=>d.isValidElement(u)).filter(({props:u})=>u.tabContentRef&&u.tabContentRef.current).forEach(u=>u.props.tabContentRef.current.hidden=!0),r.current&&(r.current.hidden=!1)),this.props.mountOnEnter&&this.setState({shownKeys:i.concat(l)})}componentDidMount(){this.props.isVertical||(bt&&window.addEventListener("resize",this.handleScrollButtons,!1),this.direction=getComputedStyle(this.tabList.current).getPropertyValue("direction"),this.handleScrollButtons())}componentWillUnmount(){var n;this.props.isVertical||bt&&window.removeEventListener("resize",this.handleScrollButtons,!1),clearTimeout(this.scrollTimeout),(n=this.leftScrollButtonRef.current)===null||n===void 0||n.removeEventListener("transitionend",this.hideScrollButtons)}componentDidUpdate(n,l){const{activeKey:r,mountOnEnter:i,isOverflowHorizontal:a,children:o}=this.props,{shownKeys:u,overflowingTabCount:c,enableScrollButtons:s}=this.state;n.activeKey!==r&&i&&u.indexOf(r)<0&&this.setState({shownKeys:u.concat(r)}),n.children&&o&&d.Children.toArray(n.children).length!==d.Children.toArray(o).length&&this.handleScrollButtons();const g=this.countOverflowingElements(this.tabList.current);a&&g&&this.setState({overflowingTabCount:g+c}),!l.enableScrollButtons&&s?(this.setState({renderScrollButtons:!0}),setTimeout(()=>{var p;(p=this.leftScrollButtonRef.current)===null||p===void 0||p.addEventListener("transitionend",this.hideScrollButtons),this.setState({showScrollButtons:!0})},100)):l.enableScrollButtons&&!s&&this.setState({showScrollButtons:!1}),this.direction=getComputedStyle(this.tabList.current).getPropertyValue("direction")}render(){const n=this.props,{className:l,children:r,activeKey:i,defaultActiveKey:a,id:o,isFilled:u,isSecondary:c,isVertical:s,isBox:g,hasNoBorderBottom:p,leftScrollAriaLabel:v,rightScrollAriaLabel:w,backScrollAriaLabel:y,forwardScrollAriaLabel:E,"aria-label":B,component:Y,ouiaId:D,ouiaSafe:Q,mountOnEnter:$,unmountOnExit:Z,usePageInsets:ee,inset:ae,variant:H,expandable:b,isExpanded:T,defaultIsExpanded:j,toggleText:M,toggleAriaLabel:K,addButtonAriaLabel:Se,onToggle:_e,onClose:Nt,onAdd:st,isOverflowHorizontal:me}=n,At=J(n,["className","children","activeKey","defaultActiveKey","id","isFilled","isSecondary","isVertical","isBox","hasNoBorderBottom","leftScrollAriaLabel","rightScrollAriaLabel","backScrollAriaLabel","forwardScrollAriaLabel","aria-label","component","ouiaId","ouiaSafe","mountOnEnter","unmountOnExit","usePageInsets","inset","variant","expandable","isExpanded","defaultIsExpanded","toggleText","toggleAriaLabel","addButtonAriaLabel","onToggle","onClose","onAdd","isOverflowHorizontal"]),{showScrollButtons:Ft,renderScrollButtons:ct,disableBackScrollButton:dt,disableForwardScrollButton:ut,shownKeys:Bt,uncontrolledActiveKey:Lt,uncontrolledIsExpandedLocal:Vt,overflowingTabCount:xe}=this.state,te=d.Children.toArray(r).filter(C=>d.isValidElement(C)).filter(({props:C})=>!C.isHidden),Rt=te.slice(0,te.length-xe),jt=te.slice(te.length-xe).map(C=>C.props),mt=o||en(),Dt=Y===be.nav?"nav":"div",Ie=a!==void 0?Lt:i,ke=j!==void 0?Vt:T,Mt=(C,pe)=>{T===void 0?this.setState({uncontrolledIsExpandedLocal:pe}):_e(C,pe)},pt=me&&xe>0,Kt=typeof me=="object"?Object.assign({},me):{};return d.createElement(ln,{value:{variant:H,mountOnEnter:$,unmountOnExit:Z,localActiveKey:Ie,uniqueId:mt,handleTabClick:(...C)=>this.handleTabClick(...C),handleTabClose:Nt}},d.createElement(Dt,Object.assign({"aria-label":B,className:O(h.tabs,u&&h.modifiers.fill,c&&h.modifiers.secondary,s&&h.modifiers.vertical,s&&b&&yt(b,h),s&&b&&ke&&h.modifiers.expanded,g&&h.modifiers.box,Ft&&h.modifiers.scrollable,ee&&h.modifiers.pageInsets,p&&h.modifiers.noBorderBottom,yt(ae,h),mn[H],pt&&h.modifiers.overflow,l)},ve(le.displayName,D!==void 0?D:this.state.ouiaStateId,Q),{id:o&&o},At),b&&s&&d.createElement(tn,null,C=>d.createElement("div",{className:O(h.tabsToggle)},d.createElement("div",{className:O(h.tabsToggleButton)},d.createElement(ne,{onClick:pe=>Mt(pe,!ke),variant:"plain","aria-label":K,"aria-expanded":ke,id:`${C}-button`,"aria-labelledby":`${C}-text ${C}-button`},d.createElement("span",{className:O(h.tabsToggleIcon)},d.createElement(Te,{"arian-hidden":"true"})),M&&d.createElement("span",{className:O(h.tabsToggleText),id:`${C}-text`},M))))),ct&&d.createElement("button",{type:"button",className:O(h.tabsScrollButton,c&&vt.modifiers.secondary),"aria-label":y||v,onClick:this.scrollBack,disabled:dt,"aria-hidden":dt,ref:this.leftScrollButtonRef},d.createElement(nn,null)),d.createElement("ul",{className:O(h.tabsList),ref:this.tabList,onScroll:this.handleScrollButtons,role:"tablist"},me?Rt:te,pt&&d.createElement(wt,Object.assign({overflowingTabs:jt},Kt))),ct&&d.createElement("button",{type:"button",className:O(h.tabsScrollButton,c&&vt.modifiers.secondary),"aria-label":E||w,onClick:this.scrollForward,disabled:ut,"aria-hidden":ut},d.createElement(Te,null)),st!==void 0&&d.createElement("span",{className:O(h.tabsAdd)},d.createElement(ne,{variant:"plain","aria-label":Se||"Add tab",onClick:st},d.createElement(cn,null)))),te.filter(C=>C.props.children&&!(Z&&C.props.eventKey!==Ie)&&!($&&Bt.indexOf(C.props.eventKey)===-1)).map(C=>d.createElement(un,{key:C.props.eventKey,activeKey:Ie,child:C,id:C.props.id||mt,ouiaId:C.props.ouiaId})))}}le.displayName="Tabs";le.defaultProps={activeKey:0,onSelect:()=>{},isFilled:!1,isSecondary:!1,isVertical:!1,isBox:!1,hasNoBorderBottom:!1,leftScrollAriaLabel:"Scroll left",backScrollAriaLabel:"Scroll back",rightScrollAriaLabel:"Scroll right",forwardScrollAriaLabel:"Scroll forward",component:be.div,mountOnEnter:!1,unmountOnExit:!1,ouiaSafe:!0,variant:"default",onToggle:(e,n)=>{}};const pn=e=>{var r;const[n,l]=_.useState();return _.useEffect(()=>{for(let i=0;i<e.length;i++){const a=e[i].value;if(typeof a=="object"){if(Array.isArray(a)&&a.length>0){l(e[i].name);break}else if(!Array.isArray(a)&&Object.keys(a).length>0){l(e[i].name);break}}else if(a!==void 0&&a!==""){l(e[i].name);break}}},[e]),n??((r=e==null?void 0:e[0])==null?void 0:r.name)},de=(e,n,l,r)=>{const i=e==null?void 0:e[l];return!(n!=null&&n.length)||n.includes(r?qt(i):i)},hn=(e,n)=>!!(!(n!=null&&n.length)||n.includes(U.Fixable)&&e.componentFixedVersion||n.includes(U.Unavailable)&&!e.componentFixedVersion),fn=(e,n)=>{var o,u;const{statusFilters:l=[],cveIdFilters:r=[],componentFilters:i=[],severityFilters:a=[]}=n;return!se(e)&&((o=e==null?void 0:e.result)!=null&&o.vulnerabilities)?(u=e.result.vulnerabilities)==null?void 0:u.filter(c=>hn(c,l)&&de(c,r,"cveId")&&de(c,i,"componentName")&&de(c,a,"cveSeverity",!0)):[]},gn=(e,n)=>{var i;const l=((i=e==null?void 0:e.result)==null?void 0:i.vulnerabilities)??[],{componentFilters:r=[]}=n;return{filteredacsImageScanResult:fn(e,n),filteredacsImageScanResultByComponents:l.filter(a=>de(a,r,"componentName"))}},Tt=(e,n,l)=>{var r,i,a;return(a=(i=(r=e==null?void 0:e.results)==null?void 0:r[0])==null?void 0:i.violatedPolicies)==null?void 0:a.filter(o=>de(o,l,"severity",!0)&&(!n||o.name.toLowerCase().indexOf(n.toLowerCase())!==-1))},bn=(e,n)=>({filteredacsImageCheckResults:Tt(e,n.nameFilter,n.acsImageCheckSeverityFilters)}),yn=(e,n)=>({filteredacsDeploymentCheckResults:Tt(e,n.acsPolicyNameFilter,n.acsDeploymentCheckSeverityFilters)}),Ot=d.createContext(null),vn=Pt(({acsImageScanResult:e,acsImageCheckResults:n,acsDeploymentCheckResults:l,children:r})=>{const{state:{nameFilter:i,cveIdFilters:a,componentFilters:o,statusFilters:u,severityFilters:c,acsImageCheckSeverityFilters:s,acsPolicyNameFilter:g,acsDeploymentCheckSeverityFilters:p}}=F(),{filteredacsImageScanResult:v,filteredacsImageScanResultByComponents:w}=gn(e,{componentFilters:o,statusFilters:u,cveIdFilters:a,severityFilters:c}),{filteredacsImageCheckResults:y}=bn(n,{acsImageCheckSeverityFilters:s,nameFilter:i}),{filteredacsDeploymentCheckResults:E}=yn(l,{acsDeploymentCheckSeverityFilters:p,acsPolicyNameFilter:g});return t(Ot.Provider,{value:{acsImageScanResult:e,filteredacsImageScanResult:v,filteredacsImageScanResultByComponents:w,acsImageCheckResults:n,filteredacsImageCheckResults:y,acsDeploymentCheckResults:l,filteredacsDeploymentCheckResults:E},children:r})}),R=()=>{const e=d.useContext(Ot);if(e===null)throw new Error("useACSContext must be within a ACSContextProvider");return e};try{AdvancedClusterSecurityContext.displayName="AdvancedClusterSecurityContext",AdvancedClusterSecurityContext.__docgenInfo={description:"",displayName:"AdvancedClusterSecurityContext",props:{acsImageScanResult:{defaultValue:null,description:"",name:"acsImageScanResult",required:!0,type:{name:"ACSImageScanResult"}},acsImageCheckResults:{defaultValue:null,description:"",name:"acsImageCheckResults",required:!0,type:{name:"ACSCheckResults"}},acsDeploymentCheckResults:{defaultValue:null,description:"",name:"acsDeploymentCheckResults",required:!0,type:{name:"ACSCheckResults"}}}}}catch{}const ye=e=>{const{summary:n}=e;return{[I.Critical]:(n==null?void 0:n.CRITICAL)??0,[I.High]:(n==null?void 0:n.HIGH)??0,[I.Medium]:(n==null?void 0:n.MEDIUM)??0,[I.Low]:(n==null?void 0:n.LOW)??0}},at=e=>{const n={[z.Breaking]:0,[z.NotBreaking]:0};return e==null?void 0:e.reduce((l,r)=>(r.failingCheck?l[z.Breaking]+=1:l[z.NotBreaking]+=1,l),n)},Ln=(e,n)=>{var c,s;const l=[...((c=e==null?void 0:e.results)==null?void 0:c[0].violatedPolicies)??[],...((s=n==null?void 0:n.results)==null?void 0:s[0].violatedPolicies)??[]],{Breaking:r}=at(l),{Critical:i,High:a}=ye(e),{Critical:o,High:u}=ye(n);return r+i+a+o+u>0},Ee=()=>{const{acsDeploymentCheckResults:e}=R(),n=d.useMemo(()=>xt(e),[e]),l=d.useMemo(()=>{var r,i;return at((i=(r=e==null?void 0:e.results)==null?void 0:r[0])==null?void 0:i.violatedPolicies)},[e]);return m(S,{justifyContent:{default:"justifyContentSpaceEvenly"},children:[t(f,{grow:{default:"grow"},children:m(X,{isCompact:!0,style:{marginBottom:"var(--pf-v5-global--spacer--sm)"},children:[t(W,{children:"Violations by severity"}),t(G,{children:m(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:[m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:A(I.Critical),count:n[I.Critical]})}),t(f,{children:t(x,{text:A(I.Medium),count:n[I.Medium]})})]}),m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:A(I.High),count:n[I.High]})}),t(f,{children:t(x,{text:A(I.Low),count:n[I.Low]})})]})]})})]})}),t(f,{grow:{default:"grow"},children:m(X,{isCompact:!0,children:[t(W,{children:"Failing policy checks"}),t(G,{children:t(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:fe(z.Breaking,l)})}),t(f,{children:t(x,{text:fe(z.NotBreaking,l)})})]})})})]})})]})};try{Ee.displayName="DeploymentCheckSummary",Ee.__docgenInfo={description:"",displayName:"DeploymentCheckSummary",props:{}}}catch{}const Ne=({data:e})=>t(ie,{children:m(P,{children:[t(k,{children:e.name}),t(k,{children:A(e.severity)}),t(k,{children:e.failingCheck?"yes":"no"}),t(k,{children:e.description}),t(k,{children:e.violation}),t(k,{children:e.remediation})]})});try{Ne.displayName="DeploymentCheckRow",Ne.__docgenInfo={description:"",displayName:"DeploymentCheckRow",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ViolatedPolicy"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}}}}}catch{}const Cn=["","name","severity","failingCheck"],Sn=()=>{const[e,n]=d.useState(2),[l,r]=d.useState("asc"),i=c=>({sortBy:{index:e,direction:l},onSort:(s,g,p)=>{n(g),r(p)},columnIndex:c}),{filteredacsDeploymentCheckResults:a}=R(),{onClearAllFilters:o}=F(),u=d.useMemo(()=>(a??[]).sort(He(Cn[e],l)),[l,e,a]);return m(tt,{variant:"compact","data-testid":"deployment-check-table",children:[t(nt,{children:m(P,{children:[t(N,{width:20,sort:i(1),children:"Name"}),t(N,{width:10,sort:i(2),children:"Severity"}),t(N,{width:15,sort:i(3),children:"Breaks build"}),t(N,{width:20,children:"Description"}),t(N,{width:20,children:"Violation"}),t(N,{width:20,children:"Remediation"})]})}),(u==null?void 0:u.length)>0?u.map((c,s)=>t(Ne,{rowIndex:s,data:c},s)):t(ie,{children:t(P,{children:t(k,{colSpan:8,children:t(Ue,{onClearAllFilters:()=>o(V.deploymentCheck)})})})})]})},Ae=()=>{var n,l,r,i;const{acsDeploymentCheckResults:e}=R();return t(ze,{style:{marginBottom:"var(--pf-v5-global--spacer--sm)"},children:m(Xe,{component:We.p,children:["This task returns ACS vulnerability deployment check results for deployment:"," ",(i=(r=(l=(n=e==null?void 0:e.results)==null?void 0:n[0])==null?void 0:l.metadata)==null?void 0:r.additionalInfo)==null?void 0:i.name]})})};try{Ae.displayName="DeploymentCheckTitle",Ae.__docgenInfo={description:"",displayName:"DeploymentCheckTitle",props:{}}}catch{}const ue=({toggleName:e,categoryName:n,data:l,filters:r,addFilter:i,removeFilter:a})=>{const{onDeleteChip:o}=F(),[u,c]=d.useState(!1),s=()=>{c(!u)},g=p=>{var v;return m(lt,{ref:p,onClick:s,isExpanded:u,"data-testid":`${(v=typeof n=="string"?n:n.name)==null?void 0:v.toLowerCase()}-filter-menu`,style:{width:"200px"},children:[e," ",(r==null?void 0:r.length)>0&&t(ge,{isRead:!0,children:r.length})]})};return t(Ge,{chips:r,categoryName:n,deleteChip:o,children:t(Je,{"aria-label":e,"toggle-aria-label":`${e} filter menu`,isOpen:u,onOpenChange:p=>c(p),toggle:g,onSelect:(p,v)=>{(p==null?void 0:p.target).checked?i(String(v)):a(String(v))},children:t(Ye,{children:Object.keys(l).map(p=>t(Qe,{value:p,"aria-label":p,"data-testid":`${typeof n=="string"?n:n.name}-filter-${p}`,isSelected:r.includes(p),hasCheckbox:!0,children:m(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:[t(f,{children:p}),t(f,{children:l[p]})]})},p))})})})};try{ue.displayName="SelectFilter",ue.__docgenInfo={description:"",displayName:"SelectFilter",props:{toggleName:{defaultValue:null,description:"",name:"toggleName",required:!0,type:{name:"string"}},categoryName:{defaultValue:null,description:"",name:"categoryName",required:!0,type:{name:"string | ToolbarChipGroup"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"Record<string, string | number>"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterChip[]"}},addFilter:{defaultValue:null,description:"",name:"addFilter",required:!0,type:{name:"(item: FilterChip) => void"}},removeFilter:{defaultValue:null,description:"",name:"removeFilter",required:!0,type:{name:"(item: FilterChip) => void"}}}}}catch{}const Fe=({keyValueObject:e})=>{const{state:{acsDeploymentCheckSeverityFilters:n},dispatch:{addDeploymentCheckSeverityFilter:l,removeDeploymentCheckSeverityFilter:r}}=F();return t(ue,{toggleName:"Severity",categoryName:{key:re.acsDeploymentCheckSeverity,name:"Severity"},filters:n,addFilter:l,removeFilter:r,data:e})};try{Fe.displayName="DeploymentCheckSeverityFilter",Fe.__docgenInfo={description:"",displayName:"DeploymentCheckSeverityFilter",props:{keyValueObject:{defaultValue:null,description:"",name:"keyValueObject",required:!0,type:{name:"Record<string, string | number>"}}}}}catch{}const Be=()=>{const{acsDeploymentCheckResults:e}=R(),{state:{acsPolicyNameFilter:n},dispatch:{updateAcsPoliceNameFilter:l},onClearAllFilters:r}=F(),i=ye(e);return t(Ze,{className:"pf-m-toggle-group-container",clearAllFilters:()=>r(V.deploymentCheck),"data-testid":"deployment-check-toolbar",children:m(et,{children:[t(q,{children:t(Fe,{keyValueObject:i})}),t(q,{children:t(It,{categoryName:{key:re.acsDeploymentCheckPolicyName,name:"Name"},filter:n,updateFilter:l})})]})})};try{Be.displayName="DeploymentCheckToolbar",Be.__docgenInfo={description:"",displayName:"DeploymentCheckToolbar",props:{}}}catch{}const Le=()=>{const{acsImageCheckResults:e}=R(),n=d.useMemo(()=>xt(e),[e]),l=d.useMemo(()=>{var r,i;return at((i=(r=e==null?void 0:e.results)==null?void 0:r[0])==null?void 0:i.violatedPolicies)},[e]);return m(S,{flex:{default:"flex_1"},children:[t(f,{grow:{default:"grow"},children:m(X,{isCompact:!0,style:{marginBottom:"var(--pf-v5-global--spacer--sm)"},children:[t(W,{children:"CVEs by severity"}),t(G,{children:m(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:[m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:A(I.Critical),count:n[I.Critical]})}),t(f,{children:t(x,{text:A(I.Medium),count:n[I.Medium]})})]}),m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:A(I.High),count:n[I.High]})}),t(f,{children:t(x,{text:A(I.Low),count:n[I.Low]})})]})]})})]})}),t(f,{grow:{default:"grow"},children:m(X,{isCompact:!0,children:[t(W,{children:"Failing policy checks"}),t(G,{children:t(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:fe(z.Breaking,l)})}),t(f,{children:t(x,{text:fe(z.NotBreaking,l)})})]})})})]})})]})};try{Le.displayName="ImageCheckSummary",Le.__docgenInfo={description:"",displayName:"ImageCheckSummary",props:{}}}catch{}const Ve=({data:e})=>t(ie,{children:m(P,{children:[t(k,{children:e.name}),t(k,{children:A(e.severity)}),t(k,{children:e.failingCheck?"yes":"no"}),t(k,{children:e.description}),t(k,{children:e.violation}),t(k,{children:e.remediation})]})});try{Ve.displayName="ImageCheckRow",Ve.__docgenInfo={description:"",displayName:"ImageCheckRow",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ViolatedPolicy"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}}}}}catch{}const _n=["","name","severity","failingCheck"],xn=()=>{const[e,n]=d.useState(2),[l,r]=d.useState("asc"),i=c=>({sortBy:{index:e,direction:l},onSort:(s,g,p)=>{n(g),r(p)},columnIndex:c}),{filteredacsImageCheckResults:a}=R(),{onClearAllFilters:o}=F(),u=d.useMemo(()=>a?a.sort(He(_n[e],l)):[],[l,e,a]);return m(tt,{variant:"compact","data-testid":"image-check-table",children:[t(nt,{children:m(P,{children:[t(N,{width:20,sort:i(1),children:"Name"}),t(N,{width:10,sort:i(2),children:"Severity"}),t(N,{width:15,sort:i(3),children:"Breaks build"}),t(N,{width:20,children:"Description"}),t(N,{width:20,children:"Violation"}),t(N,{width:20,children:"Remediation"})]})}),(u==null?void 0:u.length)>0?u.map((c,s)=>t(Ve,{rowIndex:s,data:c},s)):t(ie,{children:t(P,{children:t(k,{colSpan:8,children:t(Ue,{onClearAllFilters:()=>o(V.imageCheck)})})})})]})},In=()=>{var n,l,r,i;const{acsImageCheckResults:e}=R();return t(ze,{style:{marginBottom:"var(--pf-v5-global--spacer--sm)"},children:m(Xe,{component:We.p,children:["This task returns ACS vulnerability image check results for image:"," ",t(ne,{variant:"link",isInline:!0,component:a=>{var o,u,c,s;return t("a",{...a,href:`https://${(s=(c=(u=(o=e==null?void 0:e.results)==null?void 0:o[0])==null?void 0:u.metadata)==null?void 0:c.additionalInfo)==null?void 0:s.name}`,target:"_blank",rel:"noreferrer"})},children:(i=(r=(l=(n=e==null?void 0:e.results)==null?void 0:n[0])==null?void 0:l.metadata)==null?void 0:r.additionalInfo)==null?void 0:i.name})]})})},Re=({keyValueObject:e})=>{const{state:{acsImageCheckSeverityFilters:n},dispatch:{addImageCheckSeverityFilter:l,removeImageCheckSeverityFilter:r}}=F();return t(ue,{toggleName:"Severity",categoryName:{key:re.acsImageCheckSeverity,name:"Severity"},filters:n,addFilter:l,removeFilter:r,data:e})};try{Re.displayName="ImageCheckSeverityFilter",Re.__docgenInfo={description:"",displayName:"ImageCheckSeverityFilter",props:{keyValueObject:{defaultValue:null,description:"",name:"keyValueObject",required:!0,type:{name:"Record<string, string | number>"}},displayName:{defaultValue:null,description:"",name:"displayName",required:!1,type:{name:"string"}}}}}catch{}const ot=e=>{const n={[U.Fixable]:0,[U.Unavailable]:0};return e==null?void 0:e.reduce((l,r)=>(r.componentFixedVersion?l[U.Fixable]+=1:l[U.Unavailable]+=1,l),n)},Et=e=>{var r;const n=(r=e==null?void 0:e.result)==null?void 0:r.summary;return{[L.Critical]:(n==null?void 0:n.CRITICAL)??0,[L.Important]:(n==null?void 0:n.IMPORTANT)??0,[L.Moderate]:(n==null?void 0:n.MODERATE)??0,[L.Low]:(n==null?void 0:n.LOW)??0}},kn=e=>{var n,l;return(l=(n=e==null?void 0:e.result)==null?void 0:n.vulnerabilities)==null?void 0:l.reduce((r,i)=>(r[i.cveId]?r[i.cveId]+=1:r[i.cveId]=1,r),{})},Vn=e=>{const{Critical:n,Important:l}=Et(e);return n>0||l>0},je=()=>{const{acsImageCheckResults:e,filteredacsImageScanResultByComponents:n}=R(),{state:{nameFilter:l},dispatch:{updateNameFilter:r}}=F(),{onClearAllFilters:i}=F(),a=ot(n),o=ye(e);return t(Ze,{style:{marginTop:"var(--pf-v5-global--spacer--sm)"},className:"pf-m-toggle-group-container",clearAllFilters:()=>i(V.imageCheck),"data-testid":"image-check-toolbar",children:m(et,{children:[t(q,{children:t(kt,{data:a,toggleName:"Status"})}),t(q,{children:t(Re,{keyValueObject:o})}),t(q,{children:t(It,{filter:l,updateFilter:r})})]})})};try{je.displayName="ImageCheckToolbar",je.__docgenInfo={description:"",displayName:"ImageCheckToolbar",props:{}}}catch{}const De=()=>{var i,a,o;const{acsImageScanResult:e}=R(),n=u=>{var c,s,g,p,v,w,y,E;return{Critical:((s=(c=u.result)==null?void 0:c.summary)==null?void 0:s.CRITICAL)??0,Important:((p=(g=u.result)==null?void 0:g.summary)==null?void 0:p.IMPORTANT)??0,Moderate:((w=(v=u.result)==null?void 0:v.summary)==null?void 0:w.MODERATE)??0,Low:((E=(y=u.result)==null?void 0:y.summary)==null?void 0:E.LOW)??0}},l=d.useMemo(()=>n(e),[e]),r=ot((i=e.result)==null?void 0:i.vulnerabilities);return m(S,{flex:{default:"flex_1"},justifyContent:{default:"justifyContentSpaceEvenly"},children:[t(f,{grow:{default:"grow"},children:m(X,{isCompact:!0,style:{marginBottom:"var(--pf-v5-global--spacer--sm)"},children:[t(W,{children:"CVEs by severity"}),t(G,{children:m(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:[m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:A(L.Critical),count:l[L.Critical]})}),t(f,{children:t(x,{text:A(L.Moderate),count:l[L.Moderate]})})]}),m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:A(L.Important),count:l[L.Important]})}),t(f,{children:t(x,{text:A(L.Low),count:l[L.Low]})})]})]})})]})}),t(f,{grow:{default:"grow"},children:m(X,{isCompact:!0,children:[t(W,{children:"CVEs by status"}),t(G,{children:t(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:ft(U.Fixable,r)})}),t(f,{children:t(x,{text:ft(U.Unavailable,r)})})]})})})]})}),t(f,{grow:{default:"grow"},children:m(X,{isCompact:!0,children:[t(W,{children:"Total scan results"}),t(G,{children:t(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:m(S,{direction:{default:"column"},children:[t(f,{children:t(x,{text:gt(Ct.Vulnerabilites,(a=e.result)==null?void 0:a.summary)})}),t(f,{children:t(f,{children:t(x,{text:gt(Ct.Components,(o=e.result)==null?void 0:o.summary)})})})]})})})]})})]})};try{De.displayName="ImageScanSummary",De.__docgenInfo={description:"",displayName:"ImageScanSummary",props:{}}}catch{}const Me=({data:e,rowIndex:n})=>t(ie,{"data-testid":`image-scan-row-${n}`,children:m(P,{children:[t(k,{children:t(ne,{variant:"link",isInline:!0,iconPosition:"right",icon:t(we.ExternalLinkAltIcon,{style:{fontSize:"var(--pf-v5-global--icon--FontSize--sm)"}}),component:l=>t("a",{...l,href:e.cveInfo,target:"_blank",rel:"noreferrer"}),children:e.cveId})}),t(k,{children:A(e.cveSeverity)}),t(k,{children:e.componentName}),t(k,{children:e.componentVersion}),t(k,{children:e.componentFixedVersion?m(ht,{children:[t(we.CheckCircleIcon,{color:$t.global_success_color_100.value})," ",e.componentFixedVersion]}):m(ht,{children:[" ",t(we.ExclamationTriangleIcon,{color:Ht.global_warning_color_100.value})," Unavailable"]})})]})});try{Me.displayName="ImageScanRow",Me.__docgenInfo={description:"",displayName:"ImageScanRow",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"Vulnerability"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}}}}}catch{}const wn=["","cveId","cveSeverity","componentName"],Tn=()=>{const[e,n]=d.useState(2),[l,r]=d.useState("asc"),i=c=>({sortBy:{index:e,direction:l},onSort:(s,g,p)=>{n(g),r(p)},columnIndex:c}),{filteredacsImageScanResult:a}=R(),{onClearAllFilters:o}=F(),u=d.useMemo(()=>a.sort(He(wn[e],l)),[l,e,a]);return m(tt,{variant:"compact","data-testid":"image-scan-table",children:[t(nt,{children:m(P,{children:[t(N,{width:20,sort:i(1),children:"CVE ID"}),t(N,{width:20,sort:i(2),children:"Severity"}),t(N,{width:20,sort:i(3),children:"Component"}),t(N,{width:20,children:"Component version"}),t(N,{width:20,children:"Fixed in version"})]})}),(u==null?void 0:u.length)>0?u.map((c,s)=>t(Me,{rowIndex:s,data:c},s)):t(ie,{children:t(P,{children:t(k,{colSpan:8,children:t(Ue,{onClearAllFilters:()=>o(V.imageScan)})})})})]})},On=()=>{var n,l,r,i;const{acsImageCheckResults:e}=R();return t(ze,{style:{marginBottom:"var(--pf-v5-global--spacer--sm)"},children:m(Xe,{component:We.p,children:["This task returns ACS vulnerability scan results for image:"," ",t(ne,{variant:"link",isInline:!0,component:a=>{var o,u,c,s;return t("a",{...a,href:`https://${(s=(c=(u=(o=e==null?void 0:e.results)==null?void 0:o[0])==null?void 0:u.metadata)==null?void 0:c.additionalInfo)==null?void 0:s.name}`,target:"_blank",rel:"noreferrer"})},children:(i=(r=(l=(n=e==null?void 0:e.results)==null?void 0:n[0])==null?void 0:l.metadata)==null?void 0:r.additionalInfo)==null?void 0:i.name})]})})},Ke=({data:e,path:n,title:l})=>{const{state:{componentFilters:r},dispatch:{addComponentFilter:i,resetComponentFilter:a,removeComponentFilter:o},onDeleteChip:u}=F(),[c,s]=d.useState(!1),g=d.useMemo(()=>(e==null?void 0:e.length)>0?e==null?void 0:e.reduce((y,E)=>{const B=E[n];return y[B]?y[B]+=1:y[B]=1,y},{}):{},[e,n]),p=()=>{s(!c)},v=d.useCallback(()=>{a()},[a]),w=y=>m(lt,{ref:y,isExpanded:c,onClick:p,"data-testid":"component-filter-menu",style:{width:"200px"},children:[l??"Filter by components",r.length>0&&t(ge,{isRead:!0,children:r.length})]});return t(Ge,{chips:r,categoryName:re.component,deleteChip:u,deleteChipGroup:v,children:t(Je,{isScrollable:!0,"toggle-aria-label":"Component filter menu","aria-label":"Component",isOpen:c,onOpenChange:y=>s(y),toggle:w,onSelect:(y,E)=>{(y==null?void 0:y.target).checked?i(String(E)):o(String(E))},children:t(Ye,{children:Object.keys(g).sort().map(y=>t(Qe,{hasCheckbox:!0,value:y,isSelected:r.includes(y),children:y},y))})})})};try{Ke.displayName="ComponentFilter",Ke.__docgenInfo={description:"",displayName:"ComponentFilter",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"T[]"}},path:{defaultValue:null,description:"",name:"path",required:!0,type:{name:"string | number | symbol"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}}}}}catch{}const qe=({data:e={}})=>{const{state:{cveIdFilters:n},dispatch:{addCveIdFilter:l,removeCveIdFilter:r},onDeleteChip:i}=F(),[a,o]=d.useState(!1),u=()=>{o(!a)},c=s=>m(lt,{ref:s,onClick:u,isExpanded:a,"data-testid":"cve-filter-menu",style:{width:"200px"},children:["CVE ID ",(n==null?void 0:n.length)>0&&t(ge,{isRead:!0,children:n.length})]});return t(Ge,{chips:n,categoryName:{key:re.acsImageScanCveID,name:"CVE ID"},deleteChip:i,children:t(Je,{isScrollable:!0,"aria-label":"Filter by CVE ID","toggle-aria-label":"CVE filter menu",isOpen:a,onOpenChange:s=>o(s),toggle:c,onSelect:(s,g)=>{(s==null?void 0:s.target).checked?l(String(g)):r(String(g))},children:t(Ye,{children:Object.keys(e).sort().reverse().map(s=>t(Qe,{value:s,"aria-label":s,"data-testid":`cve-filter-${s}`,isSelected:n.includes(s),hasCheckbox:!0,children:t(S,{grow:{default:"grow"},children:m(f,{children:[s," ",t(ge,{isRead:!0,children:e[s]})]})})},s))})})})};try{qe.displayName="CveIdFilter",qe.__docgenInfo={description:"",displayName:"CveIdFilter",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"Record<string, string | number>"}}}}}catch{}const Pe=({keyValueObject:e})=>{const{state:{severityFilters:n},dispatch:{addSeverityFilter:l,removeSeverityFilter:r}}=F();return t(ue,{toggleName:"Severity",categoryName:re.severity,filters:n,addFilter:l,removeFilter:r,data:e})};try{Pe.displayName="SeverityFilter",Pe.__docgenInfo={description:"",displayName:"SeverityFilter",props:{keyValueObject:{defaultValue:null,description:"",name:"keyValueObject",required:!0,type:{name:"Record<string, string | number>"}},displayName:{defaultValue:null,description:"",name:"displayName",required:!1,type:{name:"string"}}}}}catch{}const $e=()=>{var o;const{acsImageScanResult:e,filteredacsImageScanResultByComponents:n}=R(),{onClearAllFilters:l}=F(),r=ot(n),i=Et(e),a=kn(e);return t(Ze,{className:"pf-m-toggle-group-container",clearAllFilters:()=>l(V.imageScan),"data-testid":"image-scan-toolbar",children:m(et,{children:[t(q,{className:"pf-v5-u-ml-0",children:t(qe,{data:a})}),t(q,{children:t(Ke,{data:((o=e==null?void 0:e.result)==null?void 0:o.vulnerabilities)||[],path:"componentName"})}),t(q,{children:t(kt,{data:r,toggleName:"Status"})}),t(q,{children:t(Pe,{keyValueObject:i})})]})})};try{$e.displayName="ImageScanToolbar",$e.__docgenInfo={description:"",displayName:"ImageScanToolbar",props:{}}}catch{}const _t=e=>{const{acsImageScanResult:n,acsImageCheckResults:l,acsDeploymentCheckResults:r}=e,i=[n,l,r].filter(u=>!se(u)).length>0,a=[V.imageScan,V.imageCheck,V.deploymentCheck],o=pn([{name:V.imageScan,value:n},{name:V.imageCheck,value:l},{name:V.deploymentCheck,value:r}]);return i?t(vn,{...e,children:m(le,{defaultActiveKey:a.indexOf(o)??0,"data-testid":"acs-tabs",children:[!se(n)&&t(he,{eventKey:0,title:t(ce,{children:"Image Scan"}),children:m("div",{style:{marginTop:"var(--pf-v5-global--spacer--sm)"},children:[t(On,{}),t(De,{}),t($e,{}),t(Tn,{})]})}),!se(l)&&t(he,{eventKey:1,title:t(ce,{children:"Image Check"}),children:m("div",{style:{marginTop:"var(--pf-v5-global--spacer--sm)"},children:[t(In,{}),t(Le,{}),t(je,{}),t(xn,{})]})}),!se(r)&&t(he,{eventKey:2,title:t(ce,{children:"Deployment Check"}),children:m("div",{style:{marginTop:"var(--pf-v5-global--spacer--sm)"},children:[t(Ae,{}),t(Ee,{}),t(Be,{}),t(Sn,{})]})})]},o)}):null};try{_t.displayName="AdvancedClusterSecurity",_t.__docgenInfo={description:"",displayName:"AdvancedClusterSecurity",props:{acsImageScanResult:{defaultValue:null,description:"",name:"acsImageScanResult",required:!0,type:{name:"ACSImageScanResult"}},acsImageCheckResults:{defaultValue:null,description:"",name:"acsImageCheckResults",required:!0,type:{name:"ACSCheckResults"}},acsDeploymentCheckResults:{defaultValue:null,description:"",name:"acsDeploymentCheckResults",required:!0,type:{name:"ACSCheckResults"}}}}}catch{}export{_t as A,Ln as a,Vn as g};
