import{a as t,j as p,F as pt}from"./jsx-runtime-Cxo6Vr6b.js";import{r as s,R as x}from"./index-BBkUAzwr.js";import{i as ue,t as Mt,w as Kt,u as B,q as St,F as S,c as y,a as Y,b as Q,d as Z,S as I,r as F,v as ge,j as Ue,k as ze,x as D,l as re,m as Xe,y as We,z as Ge,A as Je,B as Ye,D as ae,T as Qe,n as Ze,o as K,N as _t,p as xt,E as ht,G as ft,H as qt,J as Pt}from"./StatusFilter-Dqpbgr7V.js";import{_ as ee,p as _e,n as E,B as $,r as $t,w as Ht,x as Ut,A as Ee,M as zt,y as Xt,z as Wt,D as Gt,P as Jt,F as de,o as Yt,G as bt,H as yt,I as Qt,q as gt,J as Zt,K as en,L as H,N as k,O as U,g as oe,e as q,h as w,T as et,d as tt,f as O,Q as nt,R as ve,S as V,U as vt,i as Te}from"./data-sQbVW7wR.js";const f={button:"pf-v6-c-button",dirRtl:"pf-v6-m-dir-rtl",modifiers:{fill:"pf-m-fill",scrollable:"pf-m-scrollable",noBorderBottom:"pf-m-no-border-bottom",box:"pf-m-box",vertical:"pf-m-vertical",current:"pf-m-current",secondary:"pf-m-secondary",expandable:"pf-m-expandable",nonExpandable:"pf-m-non-expandable",expandableOnSm:"pf-m-expandable-on-sm",nonExpandableOnSm:"pf-m-non-expandable-on-sm",expandableOnMd:"pf-m-expandable-on-md",nonExpandableOnMd:"pf-m-non-expandable-on-md",expandableOnLg:"pf-m-expandable-on-lg",nonExpandableOnLg:"pf-m-non-expandable-on-lg",expandableOnXl:"pf-m-expandable-on-xl",nonExpandableOnXl:"pf-m-non-expandable-on-xl",expandableOn_2xl:"pf-m-expandable-on-2xl",nonExpandableOn_2xl:"pf-m-non-expandable-on-2xl",expanded:"pf-m-expanded",subtab:"pf-m-subtab",pageInsets:"pf-m-page-insets",overflow:"pf-m-overflow",action:"pf-m-action",disabled:"pf-m-disabled",ariaDisabled:"pf-m-aria-disabled",insetNone:"pf-m-inset-none",insetSm:"pf-m-inset-sm",insetMd:"pf-m-inset-md",insetLg:"pf-m-inset-lg",insetXl:"pf-m-inset-xl",inset_2xl:"pf-m-inset-2xl",insetNoneOnSm:"pf-m-inset-none-on-sm",insetSmOnSm:"pf-m-inset-sm-on-sm",insetMdOnSm:"pf-m-inset-md-on-sm",insetLgOnSm:"pf-m-inset-lg-on-sm",insetXlOnSm:"pf-m-inset-xl-on-sm",inset_2xlOnSm:"pf-m-inset-2xl-on-sm",insetNoneOnMd:"pf-m-inset-none-on-md",insetSmOnMd:"pf-m-inset-sm-on-md",insetMdOnMd:"pf-m-inset-md-on-md",insetLgOnMd:"pf-m-inset-lg-on-md",insetXlOnMd:"pf-m-inset-xl-on-md",inset_2xlOnMd:"pf-m-inset-2xl-on-md",insetNoneOnLg:"pf-m-inset-none-on-lg",insetSmOnLg:"pf-m-inset-sm-on-lg",insetMdOnLg:"pf-m-inset-md-on-lg",insetLgOnLg:"pf-m-inset-lg-on-lg",insetXlOnLg:"pf-m-inset-xl-on-lg",inset_2xlOnLg:"pf-m-inset-2xl-on-lg",insetNoneOnXl:"pf-m-inset-none-on-xl",insetSmOnXl:"pf-m-inset-sm-on-xl",insetMdOnXl:"pf-m-inset-md-on-xl",insetLgOnXl:"pf-m-inset-lg-on-xl",insetXlOnXl:"pf-m-inset-xl-on-xl",inset_2xlOnXl:"pf-m-inset-2xl-on-xl",insetNoneOn_2xl:"pf-m-inset-none-on-2xl",insetSmOn_2xl:"pf-m-inset-sm-on-2xl",insetMdOn_2xl:"pf-m-inset-md-on-2xl",insetLgOn_2xl:"pf-m-inset-lg-on-2xl",insetXlOn_2xl:"pf-m-inset-xl-on-2xl",inset_2xlOn_2xl:"pf-m-inset-2xl-on-2xl"},tabs:"pf-v6-c-tabs",tabsAdd:"pf-v6-c-tabs__add",tabsItem:"pf-v6-c-tabs__item",tabsItemAction:"pf-v6-c-tabs__item-action",tabsItemActionIcon:"pf-v6-c-tabs__item-action-icon",tabsItemText:"pf-v6-c-tabs__item-text",tabsLink:"pf-v6-c-tabs__link",tabsLinkToggleIcon:"pf-v6-c-tabs__link-toggle-icon",tabsList:"pf-v6-c-tabs__list",tabsScrollButton:"pf-v6-c-tabs__scroll-button",tabsToggle:"pf-v6-c-tabs__toggle",tabsToggleButton:"pf-v6-c-tabs__toggle-button",tabsToggleIcon:"pf-v6-c-tabs__toggle-icon"},lt=e=>{var{children:n,tabContentRef:l,ouiaId:r,parentInnerRef:i,ouiaSafe:a}=e,o=ee(e,["children","tabContentRef","ouiaId","parentInnerRef","ouiaSafe"]);const d=o.href?"a":"button";return s.createElement(d,Object.assign({},!o.href&&{type:"button"},{ref:i},_e(lt.displayName,r,a),o),n)};lt.displayName="TabButton";const xe=s.createContext({variant:"default",mountOnEnter:!1,unmountOnExit:!1,localActiveKey:"",uniqueId:"",handleTabClick:()=>null,handleTabClose:void 0}),tn=xe.Provider,nn=xe.Consumer,ln=e=>{var{children:n,className:l,onClick:r,isDisabled:i,"aria-label":a="Tab action",innerRef:o,ouiaId:d,ouiaSafe:u}=e,c=ee(e,["children","className","onClick","isDisabled","aria-label","innerRef","ouiaId","ouiaSafe"]);return s.createElement("span",{className:E(f.tabsItemAction,l)},s.createElement($,Object.assign({ref:o,type:"button",variant:"plain","aria-label":a,onClick:r,isDisabled:i,icon:s.createElement("span",{className:E(f.tabsItemActionIcon)},n)},_e(rt.displayName,d,u),c)))},rt=s.forwardRef((e,n)=>s.createElement(ln,Object.assign({},e,{innerRef:n})));rt.displayName="TabAction";const rn=e=>{var{title:n,eventKey:l,tabContentRef:r,id:i,tabContentId:a,className:o="",ouiaId:d,isDisabled:u,isAriaDisabled:c,inoperableEvents:h=["onClick","onKeyPress"],href:m,innerRef:v,tooltip:_,closeButtonAriaLabel:b,isCloseDisabled:A=!1,actions:L}=e,z=ee(e,["title","eventKey","tabContentRef","id","tabContentId","className","ouiaId","isDisabled","isAriaDisabled","inoperableEvents","href","innerRef","tooltip","closeButtonAriaLabel","isCloseDisabled","actions"]);const X=h.reduce((N,J)=>Object.assign(Object.assign({},N),{[J]:ce=>{ce.preventDefault()}}),{}),{mountOnEnter:te,localActiveKey:R,unmountOnExit:W,uniqueId:ne,handleTabClick:se,handleTabClose:P}=s.useContext(xe);let M=a?`${a}`:`pf-tab-section-${l}-${i||ne}`;(te||W)&&l!==R&&(M=void 0);const G=!m,g=()=>{if(u)return G?null:-1;if(c)return null},T=s.createElement(lt,Object.assign({parentInnerRef:v,className:E(f.tabsLink,u&&m&&f.modifiers.disabled,c&&f.modifiers.ariaDisabled),disabled:G?u:null,"aria-disabled":u||c,tabIndex:g(),onClick:N=>se(N,l,r)},c?X:null,{id:`pf-tab-${l}-${i||ne}`,"aria-controls":M,tabContentRef:r,ouiaId:d,href:m,role:"tab","aria-selected":l===R},z),n);return s.createElement("li",{className:E(f.tabsItem,l===R&&f.modifiers.current,(P||L)&&f.modifiers.action,(u||c)&&f.modifiers.disabled,o),role:"presentation"},_?s.createElement($t,Object.assign({},_.props),T):T,L&&L,P!==void 0&&s.createElement(rt,{"aria-label":b||"Close tab",onClick:N=>P(N,l,r),isDisabled:A},s.createElement(Ht,null)))},ye=s.forwardRef((e,n)=>s.createElement(rn,Object.assign({innerRef:n},e)));ye.displayName="Tab";const an={name:"PlusIcon",height:512,width:448,svgPath:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",yOffset:0,xOffset:0},on=Ut(an),Oe={modifiers:{secondary:"pf-m-secondary",padding:"pf-m-padding"},tabContent:"pf-v6-c-tab-content",tabContentBody:"pf-v6-c-tab-content__body"},sn={default:"",secondary:Oe.modifiers.secondary},cn=e=>{var{id:n,activeKey:l,"aria-label":r,child:i,children:a,className:o,eventKey:d,innerRef:u,ouiaId:c,ouiaSafe:h}=e,m=ee(e,["id","activeKey","aria-label","child","children","className","eventKey","innerRef","ouiaId","ouiaSafe"]);if(a||i){let v;return r?v=null:v=a?`${n}`:`pf-tab-${i.props.eventKey}-${n}`,s.createElement(nn,null,({variant:_})=>{const b=sn[_];return s.createElement("section",Object.assign({ref:u,hidden:a?null:i.props.eventKey!==l,className:a?E(Oe.tabContent,o,b):E(Oe.tabContent,i.props.className,b),id:a?n:`pf-tab-section-${i.props.eventKey}-${n}`,"aria-label":r,"aria-labelledby":v,role:"tabpanel",tabIndex:0},_e("TabContent",c,h),m),a||i.props.children)})}return null},dn=s.forwardRef((e,n)=>s.createElement(cn,Object.assign({},e,{innerRef:n}))),me=e=>{var{children:n,className:l=""}=e,r=ee(e,["children","className"]);return s.createElement("span",Object.assign({className:E(f.tabsItemText,l)},r),n)};me.displayName="TabTitleText";const It=e=>{var{className:n,overflowingTabs:l=[],showTabCount:r,defaultTitleText:i="More",toggleAriaLabel:a,zIndex:o=9999,shouldPreventScrollOnItemFocus:d=!0,focusTimeoutDelay:u=0}=e,c=ee(e,["className","overflowingTabs","showTabCount","defaultTitleText","toggleAriaLabel","zIndex","shouldPreventScrollOnItemFocus","focusTimeoutDelay"]);const h=x.useRef(),m=x.useRef(),v=x.useRef(),[_,b]=x.useState(!1),{localActiveKey:A,handleTabClick:L}=x.useContext(xe),z=()=>{b(!1),m.current.focus()},X=g=>{var T;const N=(T=h==null?void 0:h.current)===null||T===void 0?void 0:T.contains(g.target);_&&N&&g.key==="Escape"&&z()},te=g=>{var T,N;const J=!(!((T=h==null?void 0:h.current)===null||T===void 0)&&T.contains(g.target)),ce=!(!((N=m==null?void 0:m.current)===null||N===void 0)&&N.contains(g.target));_&&J&&ce&&z()};x.useEffect(()=>(window.addEventListener("click",te),window.addEventListener("keydown",X),()=>{window.removeEventListener("click",te),window.removeEventListener("keydown",X)}),[_,h,m]);const R=l.find(g=>g.eventKey===A),W=R!=null&&R.title?R.title:i,ne=()=>{b(g=>!g),setTimeout(()=>{if(h!=null&&h.current){const g=h.current.querySelector("li > button,input:not(:disabled)");g&&g.focus({preventScroll:d})}},u)},se=x.createElement("li",Object.assign({className:E(f.tabsItem,f.modifiers.overflow,R&&f.modifiers.current,n),role:"presentation",ref:v},c),x.createElement("button",{type:"button",className:E(f.tabsLink,_&&f.modifiers.expanded),onClick:()=>ne(),"aria-label":a,"aria-haspopup":"menu","aria-expanded":_,role:"tab",ref:m},x.createElement(me,null,W,r&&W===i&&` (${l.length})`),x.createElement("span",{className:f.tabsLinkToggleIcon},x.createElement(Ee,null)))),P=l.map(g=>x.createElement(zt,{key:g.eventKey,itemId:g.eventKey,isSelected:A===g.eventKey},g.title)),M=(g,T)=>{z();const N=l.find(J=>J.eventKey===T).tabContentRef;L(g,T,N)},G=x.createElement(Xt,{ref:h,onSelect:(g,T)=>M(g,T)},x.createElement(Wt,null,x.createElement(Gt,null,P)));return x.createElement(x.Fragment,null,se,x.createElement(Jt,{triggerRef:m,popper:G,popperRef:h,isVisible:_,minWidth:"revert",appendTo:v.current,zIndex:o}))};It.displayName="OverflowTab";var Ce;(function(e){e.div="div",e.nav="nav"})(Ce||(Ce={}));const un={default:"",secondary:f.modifiers.secondary};class ie extends s.Component{constructor(n){super(n),this.tabList=s.createRef(),this.leftScrollButtonRef=s.createRef(),this.direction="ltr",this.scrollTimeout=null,this.countOverflowingElements=l=>Array.from(l.children).filter(i=>!de(l,i)).length,this.handleScrollButtons=()=>{const{isOverflowHorizontal:l}=this.props;clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{const r=this.tabList.current;let i=!0,a=!0,o=!1,d=0;if(r&&!this.props.isVertical&&!l){const u=!de(r,r.firstChild),c=!de(r,r.lastChild);o=u||c,i=!u,a=!c}l&&(d=this.countOverflowingElements(r)),this.setState({enableScrollButtons:o,disableBackScrollButton:i,disableForwardScrollButton:a,overflowingTabCount:d})},100)},this.scrollBack=()=>{if(this.tabList.current){const l=this.tabList.current,r=Array.from(l.children);let i,a,o;for(o=0;o<r.length&&!i;o++)de(l,r[o])&&(i=r[o],a=r[o-1]);a&&(this.direction==="ltr"?l.scrollLeft-=a.scrollWidth:l.scrollLeft+=a.scrollWidth)}},this.scrollForward=()=>{if(this.tabList.current){const l=this.tabList.current,r=Array.from(l.children);let i,a;for(let o=r.length-1;o>=0&&!i;o--)de(l,r[o])&&(i=r[o],a=r[o+1]);a&&(this.direction==="ltr"?l.scrollLeft+=a.scrollWidth:l.scrollLeft-=a.scrollWidth)}},this.hideScrollButtons=()=>{const{enableScrollButtons:l,renderScrollButtons:r,showScrollButtons:i}=this.state;!l&&!i&&r&&this.setState({renderScrollButtons:!1})},this.state={enableScrollButtons:!1,showScrollButtons:!1,renderScrollButtons:!1,disableBackScrollButton:!0,disableForwardScrollButton:!0,shownKeys:this.props.defaultActiveKey!==void 0?[this.props.defaultActiveKey]:[this.props.activeKey],uncontrolledActiveKey:this.props.defaultActiveKey,uncontrolledIsExpandedLocal:this.props.defaultIsExpanded,ouiaStateId:Yt(ie.displayName),overflowingTabCount:0},this.props.isVertical&&this.props.expandable!==void 0&&!this.props.toggleAriaLabel&&!this.props.toggleText&&console.error("Tabs:","toggleAriaLabel or the toggleText prop is required to make the toggle button accessible")}handleTabClick(n,l,r){const{shownKeys:i}=this.state,{onSelect:a,defaultActiveKey:o}=this.props;o!==void 0?this.setState({uncontrolledActiveKey:l}):a(n,l),r&&(s.Children.toArray(this.props.children).filter(d=>s.isValidElement(d)).filter(({props:d})=>d.tabContentRef&&d.tabContentRef.current).forEach(d=>d.props.tabContentRef.current.hidden=!0),r.current&&(r.current.hidden=!1)),this.props.mountOnEnter&&this.setState({shownKeys:i.concat(l)})}componentDidMount(){this.props.isVertical||(bt&&window.addEventListener("resize",this.handleScrollButtons,!1),this.direction=yt(this.tabList.current),this.handleScrollButtons())}componentWillUnmount(){var n;this.props.isVertical||bt&&window.removeEventListener("resize",this.handleScrollButtons,!1),clearTimeout(this.scrollTimeout),(n=this.leftScrollButtonRef.current)===null||n===void 0||n.removeEventListener("transitionend",this.hideScrollButtons)}componentDidUpdate(n,l){const{activeKey:r,mountOnEnter:i,isOverflowHorizontal:a,children:o}=this.props,{shownKeys:d,overflowingTabCount:u,enableScrollButtons:c}=this.state;n.activeKey!==r&&i&&d.indexOf(r)<0&&this.setState({shownKeys:d.concat(r)}),n.children&&o&&s.Children.toArray(n.children).length!==s.Children.toArray(o).length&&this.handleScrollButtons();const h=this.countOverflowingElements(this.tabList.current);a&&h&&this.setState({overflowingTabCount:h+u}),!l.enableScrollButtons&&c?(this.setState({renderScrollButtons:!0}),setTimeout(()=>{var m;(m=this.leftScrollButtonRef.current)===null||m===void 0||m.addEventListener("transitionend",this.hideScrollButtons),this.setState({showScrollButtons:!0})},100)):l.enableScrollButtons&&!c&&this.setState({showScrollButtons:!1}),this.direction=yt(this.tabList.current)}static getDerivedStateFromProps(n,l){return l.uncontrolledActiveKey===void 0||s.Children.toArray(n.children).filter(i=>s.isValidElement(i)).some(({props:i})=>i.eventKey===l.uncontrolledActiveKey)?null:{uncontrolledActiveKey:n.defaultActiveKey,shownKeys:n.defaultActiveKey!==void 0?[n.defaultActiveKey]:[n.activeKey]}}render(){const n=this.props,{className:l,children:r,activeKey:i,defaultActiveKey:a,id:o,isFilled:d,isSubtab:u,isVertical:c,isBox:h,hasNoBorderBottom:m,leftScrollAriaLabel:v,rightScrollAriaLabel:_,backScrollAriaLabel:b,forwardScrollAriaLabel:A,"aria-label":L,component:z,ouiaId:X,ouiaSafe:te,mountOnEnter:R,unmountOnExit:W,usePageInsets:ne,inset:se,variant:P,expandable:M,isExpanded:G,defaultIsExpanded:g,toggleText:T,toggleAriaLabel:N,addButtonAriaLabel:J,onToggle:ce,onClose:Et,onAdd:ot,isOverflowHorizontal:fe}=n,Ot=ee(n,["className","children","activeKey","defaultActiveKey","id","isFilled","isSubtab","isVertical","isBox","hasNoBorderBottom","leftScrollAriaLabel","rightScrollAriaLabel","backScrollAriaLabel","forwardScrollAriaLabel","aria-label","component","ouiaId","ouiaSafe","mountOnEnter","unmountOnExit","usePageInsets","inset","variant","expandable","isExpanded","defaultIsExpanded","toggleText","toggleAriaLabel","addButtonAriaLabel","onToggle","onClose","onAdd","isOverflowHorizontal"]),{showScrollButtons:At,renderScrollButtons:st,disableBackScrollButton:ct,disableForwardScrollButton:dt,shownKeys:Nt,uncontrolledActiveKey:Ft,uncontrolledIsExpandedLocal:Bt,overflowingTabCount:Ie}=this.state,le=s.Children.toArray(r).filter(C=>s.isValidElement(C)).filter(({props:C})=>!C.isHidden),Lt=le.slice(0,le.length-Ie),Rt=le.slice(le.length-Ie).map(C=>C.props),ut=o||Qt(),Vt=z===Ce.nav?"nav":"div",ke=a!==void 0?Ft:i,we=g!==void 0?Bt:G,Dt=(C,be)=>{G===void 0?this.setState({uncontrolledIsExpandedLocal:be}):ce(C,be)},mt=fe&&Ie>0,jt=typeof fe=="object"?Object.assign({},fe):{};return s.createElement(tn,{value:{variant:P,mountOnEnter:R,unmountOnExit:W,localActiveKey:ke,uniqueId:ut,handleTabClick:(...C)=>this.handleTabClick(...C),handleTabClose:Et}},s.createElement(Vt,Object.assign({"aria-label":L,className:E(f.tabs,d&&f.modifiers.fill,u&&f.modifiers.subtab,c&&f.modifiers.vertical,c&&M&&gt(M,f),c&&M&&we&&f.modifiers.expanded,h&&f.modifiers.box,At&&f.modifiers.scrollable,ne&&f.modifiers.pageInsets,m&&f.modifiers.noBorderBottom,gt(se,f),un[P],mt&&f.modifiers.overflow,l)},_e(ie.displayName,X!==void 0?X:this.state.ouiaStateId,te),{id:o&&o},Ot),M&&c&&s.createElement(Zt,null,C=>s.createElement("div",{className:E(f.tabsToggle)},s.createElement("div",{className:E(f.tabsToggleButton)},s.createElement($,{onClick:be=>Dt(be,!we),variant:"plain","aria-label":N,"aria-expanded":we,id:`${C}-button`,"aria-labelledby":`${C}-text ${C}-button`,icon:s.createElement("span",{className:E(f.tabsToggleIcon)},s.createElement(Ee,null))},T&&s.createElement("span",{id:`${C}-text`},T))))),st&&s.createElement("div",{className:E(f.tabsScrollButton)},s.createElement($,{"aria-label":b||v,onClick:this.scrollBack,isDisabled:ct,"aria-hidden":ct,ref:this.leftScrollButtonRef,variant:"plain",icon:s.createElement(en,null)})),s.createElement("ul",{className:E(f.tabsList),ref:this.tabList,onScroll:this.handleScrollButtons,role:"tablist"},fe?Lt:le,mt&&s.createElement(It,Object.assign({overflowingTabs:Rt},jt))),st&&s.createElement("div",{className:E(f.tabsScrollButton)},s.createElement($,{"aria-label":A||_,onClick:this.scrollForward,isDisabled:dt,"aria-hidden":dt,variant:"plain",icon:s.createElement(Ee,null)})),ot!==void 0&&s.createElement("span",{className:E(f.tabsAdd)},s.createElement($,{variant:"plain","aria-label":J||"Add tab",onClick:ot,icon:s.createElement(on,null)}))),le.filter(C=>C.props.children&&!(W&&C.props.eventKey!==ke)&&!(R&&Nt.indexOf(C.props.eventKey)===-1)).map(C=>s.createElement(dn,{key:C.props.eventKey,activeKey:ke,child:C,id:C.props.id||ut,ouiaId:C.props.ouiaId})))}}ie.displayName="Tabs";ie.defaultProps={activeKey:0,onSelect:()=>{},isFilled:!1,isSubtab:!1,isVertical:!1,isBox:!1,hasNoBorderBottom:!1,leftScrollAriaLabel:"Scroll left",backScrollAriaLabel:"Scroll back",rightScrollAriaLabel:"Scroll right",forwardScrollAriaLabel:"Scroll forward",component:Ce.div,mountOnEnter:!1,unmountOnExit:!1,ouiaSafe:!0,variant:"default",onToggle:(e,n)=>{}};const mn=e=>{var r;const[n,l]=x.useState();return x.useEffect(()=>{for(let i=0;i<e.length;i++){const a=e[i].value;if(typeof a=="object"){if(Array.isArray(a)&&a.length>0){l(e[i].name);break}else if(!Array.isArray(a)&&Object.keys(a).length>0){l(e[i].name);break}}else if(a!==void 0&&a!==""){l(e[i].name);break}}},[e]),n??((r=e==null?void 0:e[0])==null?void 0:r.name)},pe=(e,n,l,r)=>{const i=e==null?void 0:e[l];return!(n!=null&&n.length)||n.includes(r?Mt(i):i)},pn=(e,n)=>!!(!(n!=null&&n.length)||n.includes(H.Fixable)&&e.componentFixedVersion||n.includes(H.Unavailable)&&!e.componentFixedVersion),hn=(e,n)=>{var o,d;const{statusFilters:l=[],cveIdFilters:r=[],componentFilters:i=[],severityFilters:a=[]}=n;return!ue(e)&&((o=e==null?void 0:e.result)!=null&&o.vulnerabilities)?(d=e.result.vulnerabilities)==null?void 0:d.filter(u=>pn(u,l)&&pe(u,r,"cveId")&&pe(u,i,"componentName")&&pe(u,a,"cveSeverity",!0)):[]},fn=(e,n)=>{var i;const l=((i=e==null?void 0:e.result)==null?void 0:i.vulnerabilities)??[],{componentFilters:r=[]}=n;return{filteredacsImageScanResult:hn(e,n),filteredacsImageScanResultByComponents:l.filter(a=>pe(a,r,"componentName"))}},kt=(e,n,l)=>{var r,i,a;return(a=(i=(r=e==null?void 0:e.results)==null?void 0:r[0])==null?void 0:i.violatedPolicies)==null?void 0:a.filter(o=>pe(o,l,"severity",!0)&&(!n||o.name.toLowerCase().indexOf(n.toLowerCase())!==-1))},bn=(e,n)=>({filteredacsImageCheckResults:kt(e,n.nameFilter,n.acsImageCheckSeverityFilters)}),yn=(e,n)=>({filteredacsDeploymentCheckResults:kt(e,n.acsPolicyNameFilter,n.acsDeploymentCheckSeverityFilters)}),wt=s.createContext(null),gn=Kt(({acsImageScanResult:e,acsImageCheckResults:n,acsDeploymentCheckResults:l,children:r})=>{const{state:{nameFilter:i,cveIdFilters:a,componentFilters:o,statusFilters:d,severityFilters:u,acsImageCheckSeverityFilters:c,acsPolicyNameFilter:h,acsDeploymentCheckSeverityFilters:m}}=B(),{filteredacsImageScanResult:v,filteredacsImageScanResultByComponents:_}=fn(e,{componentFilters:o,statusFilters:d,cveIdFilters:a,severityFilters:u}),{filteredacsImageCheckResults:b}=bn(n,{acsImageCheckSeverityFilters:c,nameFilter:i}),{filteredacsDeploymentCheckResults:A}=yn(l,{acsDeploymentCheckSeverityFilters:m,acsPolicyNameFilter:h});return t(wt.Provider,{value:{acsImageScanResult:e,filteredacsImageScanResult:v,filteredacsImageScanResultByComponents:_,acsImageCheckResults:n,filteredacsImageCheckResults:b,acsDeploymentCheckResults:l,filteredacsDeploymentCheckResults:A},children:r})}),j=()=>{const e=s.useContext(wt);if(e===null)throw new Error("useACSContext must be within a ACSContextProvider");return e};try{AdvancedClusterSecurityContext.displayName="AdvancedClusterSecurityContext",AdvancedClusterSecurityContext.__docgenInfo={description:"",displayName:"AdvancedClusterSecurityContext",props:{acsImageScanResult:{defaultValue:null,description:"",name:"acsImageScanResult",required:!0,type:{name:"ACSImageScanResult"}},acsImageCheckResults:{defaultValue:null,description:"",name:"acsImageCheckResults",required:!0,type:{name:"ACSCheckResults"}},acsDeploymentCheckResults:{defaultValue:null,description:"",name:"acsDeploymentCheckResults",required:!0,type:{name:"ACSCheckResults"}}}}}catch{}const Se=e=>{const{summary:n}=e;return{[k.Critical]:(n==null?void 0:n.CRITICAL)??0,[k.High]:(n==null?void 0:n.HIGH)??0,[k.Medium]:(n==null?void 0:n.MEDIUM)??0,[k.Low]:(n==null?void 0:n.LOW)??0}},it=e=>{const n={[U.Breaking]:0,[U.NotBreaking]:0};return e==null?void 0:e.reduce((l,r)=>(r.failingCheck?l[U.Breaking]+=1:l[U.NotBreaking]+=1,l),n)},Bn=(e,n)=>{var u,c;const l=[...((u=e==null?void 0:e.results)==null?void 0:u[0].violatedPolicies)??[],...((c=n==null?void 0:n.results)==null?void 0:c[0].violatedPolicies)??[]],{Breaking:r}=it(l),{Critical:i,High:a}=Se(e),{Critical:o,High:d}=Se(n);return r+i+a+o+d>0},Ae=()=>{const{acsDeploymentCheckResults:e}=j(),n=s.useMemo(()=>St(e),[e]),l=s.useMemo(()=>{var r,i;return it((i=(r=e==null?void 0:e.results)==null?void 0:r[0])==null?void 0:i.violatedPolicies)},[e]);return p(S,{justifyContent:{default:"justifyContentSpaceEvenly"},children:[t(y,{grow:{default:"grow"},children:p(Y,{isCompact:!0,style:{borderRadius:0,marginBottom:"var(--pf-t--global--spacer--sm)"},children:[t(Q,{children:"Violations by severity"}),t(Z,{children:p(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:[p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:F(k.Critical),count:n[k.Critical]})}),t(y,{children:t(I,{text:F(k.Medium),count:n[k.Medium]})})]}),p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:F(k.High),count:n[k.High]})}),t(y,{children:t(I,{text:F(k.Low),count:n[k.Low]})})]})]})})]})}),t(y,{grow:{default:"grow"},children:p(Y,{isCompact:!0,style:{borderRadius:0},children:[t(Q,{children:"Failing policy checks"}),t(Z,{children:t(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:ge(U.Breaking,l)})}),t(y,{children:t(I,{text:ge(U.NotBreaking,l)})})]})})})]})})]})};try{Ae.displayName="DeploymentCheckSummary",Ae.__docgenInfo={description:"",displayName:"DeploymentCheckSummary",props:{}}}catch{}const Ne=({data:e})=>t(oe,{children:p(q,{children:[t(w,{children:e.name}),t(w,{children:F(e.severity)}),t(w,{children:e.failingCheck?"yes":"no"}),t(w,{children:e.description}),t(w,{children:e.violation}),t(w,{children:e.remediation})]})});try{Ne.displayName="DeploymentCheckRow",Ne.__docgenInfo={description:"",displayName:"DeploymentCheckRow",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ViolatedPolicy"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}}}}}catch{}const vn=["","name","severity","failingCheck"],Cn=()=>{const[e,n]=s.useState(2),[l,r]=s.useState("asc"),i=u=>({sortBy:{index:e,direction:l},onSort:(c,h,m)=>{n(h),r(m)},columnIndex:u}),{filteredacsDeploymentCheckResults:a}=j(),{onClearAllFilters:o}=B(),d=s.useMemo(()=>(a??[]).sort(Ue(vn[e],l)),[l,e,a]);return p(et,{variant:"compact","data-testid":"deployment-check-table",children:[t(tt,{children:p(q,{children:[t(O,{width:20,sort:i(1),children:"Name"}),t(O,{width:10,sort:i(2),children:"Severity"}),t(O,{width:15,sort:i(3),children:"Breaks build"}),t(O,{width:20,children:"Description"}),t(O,{width:20,children:"Violation"}),t(O,{width:20,children:"Remediation"})]})}),(d==null?void 0:d.length)>0?d.map((u,c)=>t(Ne,{rowIndex:c,data:u},c)):t(oe,{children:t(q,{children:t(w,{colSpan:8,children:t(ze,{onClearAllFilters:()=>o(D.deploymentCheck)})})})})]})},Fe=()=>{var n,l,r,i;const{acsDeploymentCheckResults:e}=j();return t(re,{style:{marginBottom:"var(--pf-t--global--spacer--sm)"},children:p(re,{component:Xe.p,children:["This task returns ACS vulnerability deployment check results for deployment:"," ",(i=(r=(l=(n=e==null?void 0:e.results)==null?void 0:n[0])==null?void 0:l.metadata)==null?void 0:r.additionalInfo)==null?void 0:i.name]})})};try{Fe.displayName="DeploymentCheckTitle",Fe.__docgenInfo={description:"",displayName:"DeploymentCheckTitle",props:{}}}catch{}const he=({toggleName:e,categoryName:n,data:l,filters:r,addFilter:i,removeFilter:a})=>{const{onDeleteChip:o}=B(),[d,u]=s.useState(!1),c=()=>{u(!d)},h=m=>{var v;return p(nt,{ref:m,onClick:c,isExpanded:d,"data-testid":`${(v=typeof n=="string"?n:n.name)==null?void 0:v.toLowerCase()}-filter-menu`,style:{width:"200px"},children:[e," ",(r==null?void 0:r.length)>0&&t(ve,{isRead:!0,children:r.length})]})};return t(We,{labels:r,categoryName:n,deleteLabel:o,children:t(Ge,{"aria-label":e,"toggle-aria-label":`${e} filter menu`,isOpen:d,onOpenChange:m=>u(m),toggle:h,onSelect:(m,v)=>{(m==null?void 0:m.target).checked?i(String(v)):a(String(v))},children:t(Je,{children:Object.keys(l).map(m=>t(Ye,{value:m,"aria-label":m,"data-testid":`${typeof n=="string"?n:n.name}-filter-${m}`,isSelected:r.includes(m),hasCheckbox:!0,children:p(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:[t(y,{children:m}),t(y,{children:l[m]})]})},m))})})})};try{he.displayName="SelectFilter",he.__docgenInfo={description:"",displayName:"SelectFilter",props:{toggleName:{defaultValue:null,description:"",name:"toggleName",required:!0,type:{name:"string"}},categoryName:{defaultValue:null,description:"",name:"categoryName",required:!0,type:{name:"string | ToolbarLabelGroup"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"Record<string, string | number>"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterChip[]"}},addFilter:{defaultValue:null,description:"",name:"addFilter",required:!0,type:{name:"(item: FilterChip) => void"}},removeFilter:{defaultValue:null,description:"",name:"removeFilter",required:!0,type:{name:"(item: FilterChip) => void"}}}}}catch{}const Be=({keyValueObject:e})=>{const{state:{acsDeploymentCheckSeverityFilters:n},dispatch:{addDeploymentCheckSeverityFilter:l,removeDeploymentCheckSeverityFilter:r}}=B();return t(he,{toggleName:"Severity",categoryName:{key:ae.acsDeploymentCheckSeverity,name:"Severity"},filters:n,addFilter:l,removeFilter:r,data:e})};try{Be.displayName="DeploymentCheckSeverityFilter",Be.__docgenInfo={description:"",displayName:"DeploymentCheckSeverityFilter",props:{keyValueObject:{defaultValue:null,description:"",name:"keyValueObject",required:!0,type:{name:"Record<string, string | number>"}}}}}catch{}const Le=()=>{const{acsDeploymentCheckResults:e}=j(),{state:{acsPolicyNameFilter:n},dispatch:{updateAcsPoliceNameFilter:l},onClearAllFilters:r}=B(),i=Se(e);return t(Qe,{className:"pf-m-toggle-group-container",clearAllFilters:()=>r(D.deploymentCheck),"data-testid":"deployment-check-toolbar",children:p(Ze,{children:[t(K,{children:t(Be,{keyValueObject:i})}),t(K,{children:t(_t,{categoryName:{key:ae.acsDeploymentCheckPolicyName,name:"Name"},filter:n,updateFilter:l})})]})})};try{Le.displayName="DeploymentCheckToolbar",Le.__docgenInfo={description:"",displayName:"DeploymentCheckToolbar",props:{}}}catch{}const Re=()=>{const{acsImageCheckResults:e}=j(),n=s.useMemo(()=>St(e),[e]),l=s.useMemo(()=>{var r,i;return it((i=(r=e==null?void 0:e.results)==null?void 0:r[0])==null?void 0:i.violatedPolicies)},[e]);return p(S,{flex:{default:"flex_1"},children:[t(y,{grow:{default:"grow"},children:p(Y,{isCompact:!0,style:{borderRadius:0,marginBottom:"var(--pf-t--global--spacer--sm)"},children:[t(Q,{children:"CVEs by severity"}),t(Z,{children:p(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:[p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:F(k.Critical),count:n[k.Critical]})}),t(y,{children:t(I,{text:F(k.Medium),count:n[k.Medium]})})]}),p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:F(k.High),count:n[k.High]})}),t(y,{children:t(I,{text:F(k.Low),count:n[k.Low]})})]})]})})]})}),t(y,{grow:{default:"grow"},children:p(Y,{isCompact:!0,style:{borderRadius:0},children:[t(Q,{children:"Failing policy checks"}),t(Z,{children:t(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:ge(U.Breaking,l)})}),t(y,{children:t(I,{text:ge(U.NotBreaking,l)})})]})})})]})})]})};try{Re.displayName="ImageCheckSummary",Re.__docgenInfo={description:"",displayName:"ImageCheckSummary",props:{}}}catch{}const Ve=({data:e})=>t(oe,{children:p(q,{children:[t(w,{children:e.name}),t(w,{children:F(e.severity)}),t(w,{children:e.failingCheck?"yes":"no"}),t(w,{children:e.description}),t(w,{children:e.violation}),t(w,{children:e.remediation})]})});try{Ve.displayName="ImageCheckRow",Ve.__docgenInfo={description:"",displayName:"ImageCheckRow",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ViolatedPolicy"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}}}}}catch{}const Sn=["","name","severity","failingCheck"],_n=()=>{const[e,n]=s.useState(2),[l,r]=s.useState("asc"),i=u=>({sortBy:{index:e,direction:l},onSort:(c,h,m)=>{n(h),r(m)},columnIndex:u}),{filteredacsImageCheckResults:a}=j(),{onClearAllFilters:o}=B(),d=s.useMemo(()=>a?a==null?void 0:a.sort(Ue(Sn[e],l)):[],[l,e,a]);return p(et,{variant:"compact","data-testid":"image-check-table",children:[t(tt,{children:p(q,{children:[t(O,{width:20,sort:i(1),children:"Name"}),t(O,{width:10,sort:i(2),children:"Severity"}),t(O,{width:15,sort:i(3),children:"Breaks build"}),t(O,{width:20,children:"Description"}),t(O,{width:20,children:"Violation"}),t(O,{width:20,children:"Remediation"})]})}),(d==null?void 0:d.length)>0?d.map((u,c)=>t(Ve,{rowIndex:c,data:u},c)):t(oe,{children:t(q,{children:t(w,{colSpan:8,children:t(ze,{onClearAllFilters:()=>o(D.imageCheck)})})})})]})},xn=()=>{var n,l,r,i;const{acsImageCheckResults:e}=j();return t(re,{style:{marginBottom:"var(--pf-t--global--spacer--sm)"},children:p(re,{component:Xe.p,children:["This task returns ACS vulnerability image check results for image:"," ",t($,{variant:"link",isInline:!0,component:a=>{var o,d,u,c;return t("a",{...a,href:`https://${(c=(u=(d=(o=e==null?void 0:e.results)==null?void 0:o[0])==null?void 0:d.metadata)==null?void 0:u.additionalInfo)==null?void 0:c.name}`,target:"_blank",rel:"noreferrer"})},children:(i=(r=(l=(n=e==null?void 0:e.results)==null?void 0:n[0])==null?void 0:l.metadata)==null?void 0:r.additionalInfo)==null?void 0:i.name})]})})},De=({keyValueObject:e})=>{const{state:{acsImageCheckSeverityFilters:n},dispatch:{addImageCheckSeverityFilter:l,removeImageCheckSeverityFilter:r}}=B();return t(he,{toggleName:"Severity",categoryName:{key:ae.acsImageCheckSeverity,name:"Severity"},filters:n,addFilter:l,removeFilter:r,data:e})};try{De.displayName="ImageCheckSeverityFilter",De.__docgenInfo={description:"",displayName:"ImageCheckSeverityFilter",props:{keyValueObject:{defaultValue:null,description:"",name:"keyValueObject",required:!0,type:{name:"Record<string, string | number>"}},displayName:{defaultValue:null,description:"",name:"displayName",required:!1,type:{name:"string"}}}}}catch{}const at=e=>{const n={[H.Fixable]:0,[H.Unavailable]:0};return e==null?void 0:e.reduce((l,r)=>(r.componentFixedVersion?l[H.Fixable]+=1:l[H.Unavailable]+=1,l),n)},Tt=e=>{var r;const n=(r=e==null?void 0:e.result)==null?void 0:r.summary;return{[V.Critical]:(n==null?void 0:n.CRITICAL)??0,[V.Important]:(n==null?void 0:n.IMPORTANT)??0,[V.Moderate]:(n==null?void 0:n.MODERATE)??0,[V.Low]:(n==null?void 0:n.LOW)??0}},In=e=>{var n,l;return(l=(n=e==null?void 0:e.result)==null?void 0:n.vulnerabilities)==null?void 0:l.reduce((r,i)=>(r[i.cveId]?r[i.cveId]+=1:r[i.cveId]=1,r),{})},Ln=e=>{const{Critical:n,Important:l}=Tt(e);return n>0||l>0},je=()=>{const{acsImageCheckResults:e,filteredacsImageScanResultByComponents:n}=j(),{state:{nameFilter:l},dispatch:{updateNameFilter:r}}=B(),{onClearAllFilters:i}=B(),a=at(n),o=Se(e);return t(Qe,{style:{marginTop:"var(--pf-t--global--spacer--sm)"},className:"pf-m-toggle-group-container",clearAllFilters:()=>i(D.imageCheck),"data-testid":"image-check-toolbar",children:p(Ze,{children:[t(K,{children:t(xt,{data:a,toggleName:"Status"})}),t(K,{children:t(De,{keyValueObject:o})}),t(K,{children:t(_t,{filter:l,updateFilter:r})})]})})};try{je.displayName="ImageCheckToolbar",je.__docgenInfo={description:"",displayName:"ImageCheckToolbar",props:{}}}catch{}const Me=()=>{var i,a,o;const{acsImageScanResult:e}=j(),n=d=>{var u,c,h,m,v,_,b,A;return{Critical:((c=(u=d.result)==null?void 0:u.summary)==null?void 0:c.CRITICAL)??0,Important:((m=(h=d.result)==null?void 0:h.summary)==null?void 0:m.IMPORTANT)??0,Moderate:((_=(v=d.result)==null?void 0:v.summary)==null?void 0:_.MODERATE)??0,Low:((A=(b=d.result)==null?void 0:b.summary)==null?void 0:A.LOW)??0}},l=s.useMemo(()=>n(e),[e]),r=at((i=e.result)==null?void 0:i.vulnerabilities);return p(S,{flex:{default:"flex_1"},justifyContent:{default:"justifyContentSpaceEvenly"},children:[t(y,{grow:{default:"grow"},children:p(Y,{isCompact:!0,style:{borderRadius:0,marginBottom:"var(--pf-t--global--spacer--sm)"},children:[t(Q,{children:"CVEs by severity"}),t(Z,{children:p(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:[p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:F(V.Critical),count:l[V.Critical]})}),t(y,{children:t(I,{text:F(V.Moderate),count:l[V.Moderate]})})]}),p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:F(V.Important),count:l[V.Important]})}),t(y,{children:t(I,{text:F(V.Low),count:l[V.Low]})})]})]})})]})}),t(y,{grow:{default:"grow"},children:p(Y,{isCompact:!0,style:{borderRadius:0},children:[t(Q,{children:"CVEs by status"}),t(Z,{children:t(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:ht(H.Fixable,r)})}),t(y,{children:t(I,{text:ht(H.Unavailable,r)})})]})})})]})}),t(y,{grow:{default:"grow"},children:p(Y,{isCompact:!0,style:{borderRadius:0},children:[t(Q,{children:"Total scan results"}),t(Z,{children:t(S,{justifyContent:{default:"justifyContentSpaceBetween"},children:p(S,{direction:{default:"column"},children:[t(y,{children:t(I,{text:ft(vt.Vulnerabilites,(a=e.result)==null?void 0:a.summary)})}),t(y,{children:t(y,{children:t(I,{text:ft(vt.Components,(o=e.result)==null?void 0:o.summary)})})})]})})})]})})]})};try{Me.displayName="ImageScanSummary",Me.__docgenInfo={description:"",displayName:"ImageScanSummary",props:{}}}catch{}const Ke=({data:e,rowIndex:n})=>t(oe,{"data-testid":`image-scan-row-${n}`,children:p(q,{children:[t(w,{children:t($,{variant:"link",isInline:!0,iconPosition:"right",icon:t(Te.ExternalLinkAltIcon,{style:{fontSize:"var(--pf-t--global--icon--size--font--xs)"}}),component:l=>t("a",{...l,href:e.cveInfo,target:"_blank",rel:"noreferrer"}),children:e.cveId})}),t(w,{children:F(e.cveSeverity)}),t(w,{children:e.componentName}),t(w,{children:e.componentVersion}),t(w,{children:e.componentFixedVersion?p(pt,{children:[t(Te.CheckCircleIcon,{color:qt.t_global_color_status_success_100.value})," ",e.componentFixedVersion]}):p(pt,{children:[" ",t(Te.ExclamationTriangleIcon,{color:Pt.t_global_color_status_warning_100.value})," Unavailable"]})})]})});try{Ke.displayName="ImageScanRow",Ke.__docgenInfo={description:"",displayName:"ImageScanRow",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"Vulnerability"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}}}}}catch{}const kn=["","cveId","cveSeverity","componentName"],wn=()=>{const[e,n]=s.useState(2),[l,r]=s.useState("asc"),i=u=>({sortBy:{index:e,direction:l},onSort:(c,h,m)=>{n(h),r(m)},columnIndex:u}),{filteredacsImageScanResult:a}=j(),{onClearAllFilters:o}=B(),d=s.useMemo(()=>a==null?void 0:a.sort(Ue(kn[e],l)),[l,e,a]);return p(et,{variant:"compact","data-testid":"image-scan-table",children:[t(tt,{children:p(q,{children:[t(O,{width:20,sort:i(1),children:"CVE ID"}),t(O,{width:20,sort:i(2),children:"Severity"}),t(O,{width:20,sort:i(3),children:"Component"}),t(O,{width:20,children:"Component version"}),t(O,{width:20,children:"Fixed in version"})]})}),(d==null?void 0:d.length)>0?d.map((u,c)=>t(Ke,{rowIndex:c,data:u},c)):t(oe,{children:t(q,{children:t(w,{colSpan:8,children:t(ze,{onClearAllFilters:()=>o(D.imageScan)})})})})]})},Tn=()=>{var n,l,r,i;const{acsImageCheckResults:e}=j();return t(re,{style:{marginBottom:"var(--pf-t--global--spacer--sm)"},children:p(re,{component:Xe.p,children:["This task returns ACS vulnerability scan results for image:"," ",t($,{variant:"link",isInline:!0,component:a=>{var o,d,u,c;return t("a",{...a,href:`https://${(c=(u=(d=(o=e==null?void 0:e.results)==null?void 0:o[0])==null?void 0:d.metadata)==null?void 0:u.additionalInfo)==null?void 0:c.name}`,target:"_blank",rel:"noreferrer"})},children:(i=(r=(l=(n=e==null?void 0:e.results)==null?void 0:n[0])==null?void 0:l.metadata)==null?void 0:r.additionalInfo)==null?void 0:i.name})]})})},qe=({data:e,path:n,title:l})=>{const{state:{componentFilters:r},dispatch:{addComponentFilter:i,resetComponentFilter:a,removeComponentFilter:o},onDeleteChip:d}=B(),[u,c]=s.useState(!1),h=s.useMemo(()=>(e==null?void 0:e.length)>0?e==null?void 0:e.reduce((b,A)=>{const L=A[n];return b[L]?b[L]+=1:b[L]=1,b},{}):{},[e,n]),m=()=>{c(!u)},v=s.useCallback(()=>{a()},[a]),_=b=>p(nt,{ref:b,isExpanded:u,onClick:m,"data-testid":"component-filter-menu",style:{width:"200px"},children:[l??"Filter by components",r.length>0&&t(ve,{isRead:!0,children:r.length})]});return t(We,{labels:r,categoryName:ae.component,deleteLabel:d,deleteLabelGroup:v,children:t(Ge,{isScrollable:!0,"toggle-aria-label":"Component filter menu","aria-label":"Component",isOpen:u,onOpenChange:b=>c(b),toggle:_,onSelect:(b,A)=>{(b==null?void 0:b.target).checked?i(String(A)):o(String(A))},children:t(Je,{children:Object.keys(h).sort().map(b=>t(Ye,{hasCheckbox:!0,value:b,isSelected:r.includes(b),children:b},b))})})})};try{qe.displayName="ComponentFilter",qe.__docgenInfo={description:"",displayName:"ComponentFilter",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"T[]"}},path:{defaultValue:null,description:"",name:"path",required:!0,type:{name:"string | number | symbol"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}}}}}catch{}const Pe=({data:e={}})=>{const{state:{cveIdFilters:n},dispatch:{addCveIdFilter:l,removeCveIdFilter:r},onDeleteChip:i}=B(),[a,o]=s.useState(!1),d=()=>{o(!a)},u=c=>p(nt,{ref:c,onClick:d,isExpanded:a,"data-testid":"cve-filter-menu",style:{width:"200px"},children:["CVE ID ",(n==null?void 0:n.length)>0&&t(ve,{isRead:!0,children:n.length})]});return t(We,{labels:n,categoryName:{key:ae.acsImageScanCveID,name:"CVE ID"},deleteLabel:i,children:t(Ge,{isScrollable:!0,"aria-label":"Filter by CVE ID","toggle-aria-label":"CVE filter menu",isOpen:a,onOpenChange:c=>o(c),toggle:u,onSelect:(c,h)=>{(c==null?void 0:c.target).checked?l(String(h)):r(String(h))},children:t(Je,{children:Object.keys(e).sort().reverse().map(c=>t(Ye,{value:c,"aria-label":c,"data-testid":`cve-filter-${c}`,isSelected:n.includes(c),hasCheckbox:!0,children:t(S,{grow:{default:"grow"},children:p(y,{children:[c," ",t(ve,{isRead:!0,children:e[c]})]})})},c))})})})};try{Pe.displayName="CveIdFilter",Pe.__docgenInfo={description:"",displayName:"CveIdFilter",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"Record<string, string | number>"}}}}}catch{}const $e=({keyValueObject:e})=>{const{state:{severityFilters:n},dispatch:{addSeverityFilter:l,removeSeverityFilter:r}}=B();return t(he,{toggleName:"Severity",categoryName:ae.severity,filters:n,addFilter:l,removeFilter:r,data:e})};try{$e.displayName="SeverityFilter",$e.__docgenInfo={description:"",displayName:"SeverityFilter",props:{keyValueObject:{defaultValue:null,description:"",name:"keyValueObject",required:!0,type:{name:"Record<string, string | number>"}},displayName:{defaultValue:null,description:"",name:"displayName",required:!1,type:{name:"string"}}}}}catch{}const He=()=>{var o;const{acsImageScanResult:e,filteredacsImageScanResultByComponents:n}=j(),{onClearAllFilters:l}=B(),r=at(n),i=Tt(e),a=In(e);return t(Qe,{className:"pf-m-toggle-group-container",clearAllFilters:()=>l(D.imageScan),"data-testid":"image-scan-toolbar",children:p(Ze,{children:[t(K,{className:"pf-v5-u-ml-0",children:t(Pe,{data:a})}),t(K,{children:t(qe,{data:((o=e==null?void 0:e.result)==null?void 0:o.vulnerabilities)||[],path:"componentName"})}),t(K,{children:t(xt,{data:r,toggleName:"Status"})}),t(K,{children:t($e,{keyValueObject:i})})]})})};try{He.displayName="ImageScanToolbar",He.__docgenInfo={description:"",displayName:"ImageScanToolbar",props:{}}}catch{}const Ct=e=>{const{acsImageScanResult:n,acsImageCheckResults:l,acsDeploymentCheckResults:r}=e,i=[n,l,r].filter(d=>!ue(d)).length>0,a=[D.imageScan,D.imageCheck,D.deploymentCheck],o=mn([{name:D.imageScan,value:n},{name:D.imageCheck,value:l},{name:D.deploymentCheck,value:r}]);return i?t(gn,{...e,children:p(ie,{defaultActiveKey:a.indexOf(o)??0,"data-testid":"acs-tabs",children:[!ue(n)&&t(ye,{eventKey:0,title:t(me,{children:"Image Scan"}),children:p("div",{style:{marginTop:"var(--pf-t--global--spacer--sm)"},children:[t(Tn,{}),t(Me,{}),t(He,{}),t(wn,{})]})}),!ue(l)&&t(ye,{eventKey:1,title:t(me,{children:"Image Check"}),children:p("div",{style:{marginTop:"var(--pf-t--global--spacer--sm)"},children:[t(xn,{}),t(Re,{}),t(je,{}),t(_n,{})]})}),!ue(r)&&t(ye,{eventKey:2,title:t(me,{children:"Deployment Check"}),children:p("div",{style:{marginTop:"var(--pf-t--global--spacer--sm)"},children:[t(Fe,{}),t(Ae,{}),t(Le,{}),t(Cn,{})]})})]},o)}):null};try{Ct.displayName="AdvancedClusterSecurity",Ct.__docgenInfo={description:"",displayName:"AdvancedClusterSecurity",props:{acsImageScanResult:{defaultValue:null,description:"",name:"acsImageScanResult",required:!0,type:{name:"ACSImageScanResult"}},acsImageCheckResults:{defaultValue:null,description:"",name:"acsImageCheckResults",required:!0,type:{name:"ACSCheckResults"}},acsDeploymentCheckResults:{defaultValue:null,description:"",name:"acsDeploymentCheckResults",required:!0,type:{name:"ACSCheckResults"}}}}}catch{}export{Ct as A,Bn as a,Ln as g};
