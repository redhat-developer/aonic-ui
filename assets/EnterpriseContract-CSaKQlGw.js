import{a as e,j as c}from"./jsx-runtime-Cxo6Vr6b.js";import{r}from"./index-BBkUAzwr.js";import{f as vt,w as Et,u as Z,a as Tt,b as bt,d as St,F as B,c as G,S as U,h as W,I as Ot,j as Nt,k as wt,l as nt,m as Ft,T as Lt,n as jt,o as it,p as Dt,N as zt}from"./StatusFilter-Dqpbgr7V.js";import{_ as w,n as E,q as rt,r as mt,s as Rt,t as It,u as h,g as ut,e as $,h as O,v as At,T as Mt,d as Pt,f as P,B as V,i as q}from"./data-sQbVW7wR.js";const st=t=>!!(t&&!isNaN(t)),l={card:"pf-v6-c-card",descriptionList:"pf-v6-c-description-list",descriptionListDescription:"pf-v6-c-description-list__description",descriptionListGroup:"pf-v6-c-description-list__group",descriptionListTerm:"pf-v6-c-description-list__term",descriptionListTermIcon:"pf-v6-c-description-list__term-icon",descriptionListText:"pf-v6-c-description-list__text",modifiers:{inlineGrid:"pf-m-inline-grid",autoColumnWidths:"pf-m-auto-column-widths",autoFit:"pf-m-auto-fit",compact:"pf-m-compact",fluid:"pf-m-fluid",fillColumns:"pf-m-fill-columns",displayLg:"pf-m-display-lg",display_2xl:"pf-m-display-2xl",helpText:"pf-m-help-text","1Col":"pf-m-1-col","2Col":"pf-m-2-col","3Col":"pf-m-3-col",horizontal:"pf-m-horizontal",vertical:"pf-m-vertical","1ColOnSm":"pf-m-1-col-on-sm","2ColOnSm":"pf-m-2-col-on-sm","3ColOnSm":"pf-m-3-col-on-sm",horizontalOnSm:"pf-m-horizontal-on-sm",verticalOnSm:"pf-m-vertical-on-sm","1ColOnMd":"pf-m-1-col-on-md","2ColOnMd":"pf-m-2-col-on-md","3ColOnMd":"pf-m-3-col-on-md",horizontalOnMd:"pf-m-horizontal-on-md",verticalOnMd:"pf-m-vertical-on-md","1ColOnLg":"pf-m-1-col-on-lg","2ColOnLg":"pf-m-2-col-on-lg","3ColOnLg":"pf-m-3-col-on-lg",horizontalOnLg:"pf-m-horizontal-on-lg",verticalOnLg:"pf-m-vertical-on-lg","1ColOnXl":"pf-m-1-col-on-xl","2ColOnXl":"pf-m-2-col-on-xl","3ColOnXl":"pf-m-3-col-on-xl",horizontalOnXl:"pf-m-horizontal-on-xl",verticalOnXl:"pf-m-vertical-on-xl","1ColOn_2xl":"pf-m-1-col-on-2xl","2ColOn_2xl":"pf-m-2-col-on-2xl","3ColOn_2xl":"pf-m-3-col-on-2xl",horizontalOn_2xl:"pf-m-horizontal-on-2xl",verticalOn_2xl:"pf-m-vertical-on-2xl"}},Wt={name:"--pf-v6-c-description-list--GridTemplateColumns--min",value:"0",var:"var(--pf-v6-c-description-list--GridTemplateColumns--min)"},$t={name:"--pf-v6-c-description-list--m-horizontal__term--width",value:"fit-content(20ch)",var:"var(--pf-v6-c-description-list--m-horizontal__term--width)"},kt={name:`--${l.descriptionList}_term-width`},ot=(t,i)=>{const n=i;return Object.keys(n||{}).reduce((s,o)=>o==="default"?Object.assign(Object.assign({},s),{[t]:n[o]}):Object.assign(Object.assign({},s),{[`${t}-on-${o}`]:n[o]}),{})},ft=t=>{var{className:i="",children:n=null,isHorizontal:s=!1,isAutoColumnWidths:o,isAutoFit:a,isInlineGrid:p,isCompact:v,isFluid:g,isFillColumns:u,displaySize:C="default",columnModifier:d,autoFitMinModifier:T,termWidth:m,horizontalTermWidthModifier:y,orientation:F,style:f}=t,L=w(t,["className","children","isHorizontal","isAutoColumnWidths","isAutoFit","isInlineGrid","isCompact","isFluid","isFillColumns","displaySize","columnModifier","autoFitMinModifier","termWidth","horizontalTermWidthModifier","orientation","style"]);return a&&T&&(f=Object.assign(Object.assign({},f),ot(Wt.name,T))),m&&(f=Object.assign(Object.assign({},f),{[kt.name]:m})),s&&y&&(f=Object.assign(Object.assign({},f),ot($t.name,y))),r.createElement("dl",Object.assign({className:E(l.descriptionList,(s||g)&&l.modifiers.horizontal,o&&l.modifiers.autoColumnWidths,a&&l.modifiers.autoFit,rt(d,l),rt(F,l),p&&l.modifiers.inlineGrid,v&&l.modifiers.compact,g&&l.modifiers.fluid,u&&l.modifiers.fillColumns,C==="lg"&&l.modifiers.displayLg,C==="2xl"&&l.modifiers.display_2xl,i),style:f},L),n)};ft.displayName="DescriptionList";const D=t=>{var{children:i=null,className:n}=t,s=w(t,["children","className"]);return r.createElement("dd",Object.assign({className:E(l.descriptionListDescription,n)},s),r.createElement("div",{className:E(l.descriptionListText)},i))};D.displayName="DescriptionListDescription";const z=t=>{var{className:i,children:n}=t,s=w(t,["className","children"]);return r.createElement("div",Object.assign({className:E(l.descriptionListGroup,i)},s),n)};z.displayName="DescriptionListGroup";const R=t=>{var{children:i,className:n,icon:s}=t,o=w(t,["children","className","icon"]);return r.createElement("dt",Object.assign({className:E(l.descriptionListTerm,n)},o),s?r.createElement("span",{className:E(l.descriptionListTermIcon)},s):null,r.createElement("span",{className:E(l.descriptionListText)},i))};R.displayName="DescriptionListTerm";const H={modifiers:{helpText:"pf-m-help-text"},timestamp:"pf-v6-c-timestamp"};var at;(function(t){t.full="full",t.long="long",t.medium="medium",t.short="short"})(at||(at={}));var X;(function(t){t.default="default",t.custom="custom"})(X||(X={}));const ht=t=>{var{children:i,className:n,customFormat:s,date:o,dateFormat:a,displaySuffix:p="",is12Hour:v,locale:g,shouldDisplayUTC:u,timeFormat:C,tooltip:d}=t,T=w(t,["children","className","customFormat","date","dateFormat","displaySuffix","is12Hour","locale","shouldDisplayUTC","timeFormat","tooltip"]);const[m,y]=r.useState(()=>{const x=new Date(o);return st(x)?x:new Date});r.useEffect(()=>{const x=new Date(o);st(x)&&x.toString()!==new Date(m).toString()?y(x):o||y(new Date)},[o]);const F=C&&!s,f=Object.assign(Object.assign(Object.assign({},a&&!s&&{dateStyle:a}),s&&Object.assign({},s)),v!==void 0&&{hour12:v}),L=new Date(m).toLocaleString(g,Object.assign(Object.assign({},f),F&&{timeStyle:C})),A=C!=="short"?"medium":"short",b=x=>new Date(x).toUTCString().slice(0,-3),_=new Date(b(m)).toLocaleString(g,Object.assign(Object.assign({},f),F&&{timeStyle:A})),M=C==="full"?"Coordinated Universal Time":"UTC",S=x=>`${_} ${x||M}`,j=u?S(p):`${L}${p?" "+p:""}`,{dateTime:_t}=T,xt=w(T,["dateTime"]),et=r.createElement("span",Object.assign({className:E(H.timestamp,d&&H.modifiers.helpText,n)},d&&{tabIndex:0},xt),r.createElement("time",{className:`${H.timestamp}__text`,dateTime:_t||new Date(m).toISOString()},i||j));return d?r.createElement(mt,Object.assign({content:d.variant===X.default?S(d.suffix):d.content},d.tooltipProps),et):et};ht.displayName="Timestamp";const I={dirRtl:"pf-v6-m-dir-rtl",truncate:"pf-v6-c-truncate",truncateEnd:"pf-v6-c-truncate__end",truncateStart:"pf-v6-c-truncate__start"};var N;(function(t){t.start="start",t.end="end",t.middle="middle"})(N||(N={}));const Bt={start:I.truncateEnd,end:I.truncateStart},lt=12,ct=(t,i)=>[t.slice(0,t.length-i),t.slice(-i)],gt=t=>{var{className:i,position:n="end",tooltipPosition:s="top",trailingNumChars:o=7,content:a}=t,p=w(t,["className","position","tooltipPosition","trailingNumChars","content"]);const[v,g]=r.useState(!0),[u,C]=r.useState(null),[d,T]=r.useState(null),m=r.useRef(null),y=r.useRef(null),F=r.useRef(null),f=b=>{const _=getComputedStyle(b);return parseFloat(_.width)-parseFloat(_.paddingLeft)-parseFloat(_.paddingRight)-parseFloat(_.borderRight)-parseFloat(_.borderLeft)},L=(b,_,M)=>{const S=b.scrollWidth,j=M.length;return S/j*_+S};r.useEffect(()=>{m&&m.current&&!d&&T(m.current),y&&y.current.parentElement.parentElement&&!u&&C(y.current.parentElement.parentElement)},[m,y]),r.useEffect(()=>{if(d&&u&&!F.current){const b=L(d,o,a),_=n==="middle"?b:d.scrollWidth,S=vt(u,()=>{const j=f(u);g(_>=j)});return()=>{S()}}},[d,u]);const A=r.createElement("span",Object.assign({ref:y,className:E(I.truncate,i)},p),(n===N.end||n===N.start)&&r.createElement("span",{ref:m,className:Bt[n]},a,n===N.start&&r.createElement(r.Fragment,null,"â€Ž")),n===N.middle&&a.slice(0,a.length-o).length>lt&&r.createElement(r.Fragment,null,r.createElement("span",{ref:m,className:I.truncateStart},ct(a,o)[0]),r.createElement("span",{className:I.truncateEnd},ct(a,o)[1])),n===N.middle&&a.slice(0,a.length-o).length<=lt&&a);return v?r.createElement(mt,{hidden:!v,position:s,content:a},A):A};gt.displayName="Truncate";const Ct=t=>{var{children:i=null}=t,n=Rt(t,["children"]);return r.createElement("div",Object.assign({},n,{className:E(It.tableExpandableRowContent)}),i)};Ct.displayName="ExpandableRowContent";const k=r.createContext(null),Gt=Et(({enterpriseContractPolicies:t,children:i})=>{const{state:{nameFilter:n,statusFilters:s}}=Z(),o=r.useMemo(()=>t==null?void 0:t.filter(a=>(!n||a.title.toLowerCase().indexOf(n.toLowerCase())!==-1)&&(!s.length||s.includes(a.status))),[t,n,s]);return e(k.Provider,{value:{enterpriseContractPolicies:t,filteredECResults:o},children:e("div",{"data-testid":"enterprise-contract",children:i})})}),tt=()=>{const t=r.useContext(k);if(t===null)throw new Error("useEnterpriseContractContext must be within a EnterpriseContractContextProvider");return t};try{k.displayName="EnterpriseContractContext",k.__docgenInfo={description:"",displayName:"EnterpriseContractContext",props:{enterpriseContractPolicies:{defaultValue:null,description:"",name:"enterpriseContractPolicies",required:!0,type:{name:"EnterpriseContractPolicy[]"}}}}}catch{}const yt=t=>{var n;const i={[h.successes]:0,[h.warnings]:0,[h.failed]:0};return(n=Array.isArray(t)?t:[])==null?void 0:n.reduce((s,o)=>(s[o.status]?s[o.status]+=1:s[o.status]=1,s),i)},dt=[h.successes,h.warnings,h.failed],Jt=t=>t.reduce((i,{status:n})=>(dt.indexOf(n)||0)>dt.indexOf(i)?n:i,""),Y=()=>{const{enterpriseContractPolicies:t}=tt(),i=r.useMemo(()=>yt(t),[t]);return c(Tt,{style:{borderRadius:0,width:"250px",marginBottom:"var(--pf-t--global--spacer--sm)"},isCompact:!0,children:[e(bt,{children:"Summary"}),e(St,{children:c(B,{justifyContent:{default:"justifyContentSpaceBetween"},children:[c(B,{direction:{default:"column"},children:[e(G,{children:e(U,{text:W(h.failed),count:i[h.failed]})}),e(G,{children:e(U,{text:W(h.warnings),count:i[h.warnings]})})]}),e(B,{direction:{default:"column"},children:e(G,{children:e(U,{text:W(h.successes),count:i[h.successes]})})})]})})]})};try{Y.displayName="EnterpriseContractSummary",Y.__docgenInfo={description:"",displayName:"EnterpriseContractSummary",props:{}}}catch{}const J=({data:t,rowIndex:i})=>{var o;const[n,s]=r.useState(!1);return c(ut,{isExpanded:n,"data-testid":"row",children:[c($,{"data-testid":`ec-row-${i}`,isBorderRow:!0,children:[e(O,{"data-testid":`ec-row-expand-${i}`,expand:{rowIndex:i,isExpanded:n,onToggle:()=>s(a=>!a)}}),e(O,{children:t.title??"-"}),e(O,{"data-testid":"rule-status",children:W(t.status)}),e(O,{children:t.msg?e(gt,{content:t.msg}):"-"})]}),c($,{isExpanded:n,"data-testid":`ec-row-expanded-${i}`,children:[e(O,{}),e(O,{colSpan:4,children:e(Ct,{children:c(ft,{isAutoColumnWidths:!0,columnModifier:{default:"3Col"},children:[c(z,{children:[e(R,{children:"Rule Description"}),e(D,{children:t.description??"-"})]}),(o=t==null?void 0:t.collection)!=null&&o.length?c(z,{children:[e(R,{children:"Collection"}),e(D,{children:e("a",{href:"https://enterprisecontract.dev/docs/ec-policies/release_policy.html#_available_rule_collections",children:t.collection.join(", ")})})]}):null,t.solution?c(z,{children:[e(R,{children:"Solution"}),e(D,{children:t.solution})]}):null,t.timestamp?c(z,{children:[e(R,{children:"Effective from"}),c(D,{children:[e(Ot,{iconSize:"sm",children:e(At.GlobeAmericasIcon,{})})," ",e(ht,{date:new Date(t.timestamp),dateFormat:"medium",timeFormat:"short",is12Hour:!0})]})]}):null]})})})]})]})};try{J.displayName="EnterpriseContractRow",J.__docgenInfo={description:"",displayName:"EnterpriseContractRow",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"EnterpriseContractPolicy"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}}}}}catch{}const Ut=["","title","status","msg"],K=()=>{const[t,i]=r.useState(2),[n,s]=r.useState("asc"),{filteredECResults:o}=tt(),{onClearAllFilters:a}=Z(),p=r.useMemo(()=>o==null?void 0:o.sort(Nt(Ut[t],n)),[n,t,o]),v=g=>({sortBy:{index:t,direction:n},onSort:(u,C,d)=>{i(C),s(d)},columnIndex:g});return c(Mt,{variant:"compact","data-testid":"ec-policy-table",children:[e(Pt,{children:c($,{children:[e(P,{width:10}),e(P,{width:30,sort:v(1),children:"Rules"}),e(P,{width:10,sort:v(2),children:"Status"}),e(P,{width:30,children:"Message"})]})}),(p==null?void 0:p.length)>0?p==null?void 0:p.map((g,u)=>e(J,{rowIndex:u,data:g},u)):e(ut,{children:e($,{children:e(O,{colSpan:8,children:e(wt,{onClearAllFilters:a})})})})]})};try{K.displayName="EnterpriseContractTable",K.__docgenInfo={description:"",displayName:"EnterpriseContractTable",props:{}}}catch{}const Vt=()=>e(nt,{style:{marginBottom:"var(--pf-t--global--spacer--sm)"},children:c(nt,{component:Ft.p,children:["Enterprise Contract is a set of tools for verifying the provenance of application snapshots and validating them against a clearly defined policy.",e("br",{}),"The Enterprise Contract policy is defined using the"," ",e(V,{variant:"link",isInline:!0,iconPosition:"right",icon:e(q.ExternalLinkAltIcon,{style:{fontSize:"var(--pf-t--global--icon--size--font--xs)"}}),component:t=>e("a",{...t,href:"https://www.openpolicyagent.org/docs/latest/policy-language/",target:"_blank",rel:"noreferrer"}),children:"rego policy language"})," ","and is described here in"," ",c(V,{variant:"link",style:{padding:0},icon:e(q.ExternalLinkAltIcon,{style:{fontSize:"var(--pf-t--global--icon--size--font--xs)"}}),iconPosition:"right",component:t=>e("a",{...t,href:"https://enterprisecontract.dev/docs/ec-policies/index.html",target:"_blank",rel:"noreferrer","aria-label":"Release policy"}),children:["Release Policy"," "]})," ","and"," ",e(V,{variant:"link",style:{padding:0},icon:e(q.ExternalLinkAltIcon,{style:{fontSize:"var(--pf-t--global--icon--size--font--xs)"}}),iconPosition:"right",children:"Pipeline Policy"})]})}),Q=()=>{const{filteredECResults:t}=tt(),{state:{nameFilter:i},dispatch:{updateNameFilter:n},onClearAllFilters:s}=Z(),o=yt(t);return e(Lt,{className:"pf-m-toggle-group-container",clearAllFilters:s,children:c(jt,{children:[e(it,{children:e(Dt,{data:o})}),e(it,{children:e(zt,{filter:i,updateFilter:n,placeholder:"Search",ariaLabel:"rule search filter"})})]})})};try{Q.displayName="EnterpriseContractToolbar",Q.__docgenInfo={description:"",displayName:"EnterpriseContractToolbar",props:{}}}catch{}const pt=({enterpriseContractPolicies:t})=>c(Gt,{"data-testid":"enterprise-contract",enterpriseContractPolicies:t,children:[e(Vt,{}),e(Y,{}),e(Q,{}),e(K,{})]});try{pt.displayName="EnterpriseContract",pt.__docgenInfo={description:"",displayName:"EnterpriseContract",props:{enterpriseContractPolicies:{defaultValue:null,description:"",name:"enterpriseContractPolicies",required:!0,type:{name:"EnterpriseContractPolicy[]"}}}}}catch{}export{pt as E,Jt as g};
